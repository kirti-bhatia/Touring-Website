/*
 typeahead.js 0.11.1
 https://github.com/twitter/typeahead.js
 Copyright 2013-2015 Twitter, Inc. and other contributors; Licensed MIT
*/
(function(a,c){"function"===typeof define&&define.amd?define("bloodhound",["jquery"],function(f){return a.Bloodhound=c(f)}):"object"===typeof exports?module.exports=c(require("jquery")):a.Bloodhound=c(jQuery)})(this,function(a){var c=function(){return{isMsie:function(){return/(msie|trident)/i.test(navigator.userAgent)?navigator.userAgent.match(/(msie |rv:)(\d+(.\d+)?)/i)[2]:!1},isBlankString:function(a){return!a||/^\s*$/.test(a)},escapeRegExChars:function(a){return a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,
"\\$\x26")},isString:function(a){return"string"===typeof a},isNumber:function(a){return"number"===typeof a},isArray:a.isArray,isFunction:a.isFunction,isObject:a.isPlainObject,isUndefined:function(a){return"undefined"===typeof a},isElement:function(a){return!(!a||1!==a.nodeType)},isJQuery:function(c){return c instanceof a},toStr:function(a){return c.isUndefined(a)||null===a?"":a+""},bind:a.proxy,each:function(c,d){a.each(c,function(a,b){return d(b,a)})},map:a.map,filter:a.grep,every:function(c,d){var g=
!0;if(!c)return g;a.each(c,function(b,a){if(!(g=d.call(null,a,b,c)))return!1});return!!g},some:function(c,d){var g=!1;if(!c)return g;a.each(c,function(b,a){if(g=d.call(null,a,b,c))return!1});return!!g},mixin:a.extend,identity:function(a){return a},clone:function(c){return a.extend(!0,{},c)},getIdGenerator:function(){var a=0;return function(){return a++}},templatify:function(c){function d(){return String(c)}return a.isFunction(c)?c:d},defer:function(a){setTimeout(a,0)},debounce:function(a,d,c){var b,
m;return function(){var e=this,g=arguments;var F=c&&!b;clearTimeout(b);b=setTimeout(function(){b=null;c||(m=a.apply(e,g))},d);F&&(m=a.apply(e,g));return m}},throttle:function(a,d){var c,b,m,e;var B=0;var F=function(){B=new Date;m=null;e=a.apply(c,b)};return function(){var g=new Date,f=d-(g-B);c=this;b=arguments;0>=f?(clearTimeout(m),m=null,B=g,e=a.apply(c,b)):m||(m=setTimeout(F,f));return e}},stringify:function(a){return c.isString(a)?a:JSON.stringify(a)},noop:function(){}}}(),f=function(){function a(b){return(b=
c.toStr(b))?b.split(/\s+/):[]}function d(b){return(b=c.toStr(b))?b.split(/\W+/):[]}function g(b){return function(a){a=c.isArray(a)?a:[].slice.call(arguments,0);return function(e){var d=[];c.each(a,function(a){d=d.concat(b(c.toStr(e[a])))});return d}}}return{nonword:d,whitespace:a,obj:{nonword:g(d),whitespace:g(a)}}}(),h=function(){function f(b){this.maxSize=c.isNumber(b)?b:100;this.reset();0>=this.maxSize&&(this.set=this.get=a.noop)}function d(){this.head=this.tail=null}function g(b,a){this.key=b;
this.val=a;this.prev=this.next=null}c.mixin(f.prototype,{set:function(b,a){var e=this.list.tail;this.size>=this.maxSize&&(this.list.remove(e),delete this.hash[e.key],this.size--);(e=this.hash[b])?(e.val=a,this.list.moveToFront(e)):(e=new g(b,a),this.list.add(e),this.hash[b]=e,this.size++)},get:function(b){if(b=this.hash[b])return this.list.moveToFront(b),b.val},reset:function(){this.size=0;this.hash={};this.list=new d}});c.mixin(d.prototype,{add:function(b){this.head&&(b.next=this.head,this.head.prev=
b);this.head=b;this.tail=this.tail||b},remove:function(b){b.prev?b.prev.next=b.next:this.head=b.next;b.next?b.next.prev=b.prev:this.tail=b.prev},moveToFront:function(b){this.remove(b);this.add(b)}});return f}(),p=function(){function f(b,a){this.prefix=["__",b,"__"].join("");this.ttlKey="__ttl__";this.keyMatcher=new RegExp("^"+c.escapeRegExChars(this.prefix));this.ls=a||g;!this.ls&&this._noop()}function d(b){return JSON.stringify(c.isUndefined(b)?null:b)}try{var g=window.localStorage;g.setItem("~~~",
"!");g.removeItem("~~~")}catch(b){g=null}c.mixin(f.prototype,{_prefix:function(b){return this.prefix+b},_ttlKey:function(b){return this._prefix(b)+this.ttlKey},_noop:function(){this.get=this.set=this.remove=this.clear=this.isExpired=c.noop},_safeSet:function(b,a){try{this.ls.setItem(b,a)}catch(e){"QuotaExceededError"===e.name&&(this.clear(),this._noop())}},get:function(b){this.isExpired(b)&&this.remove(b);return a.parseJSON(this.ls.getItem(this._prefix(b)))},set:function(b,a,e){c.isNumber(e)?this._safeSet(this._ttlKey(b),
d((new Date).getTime()+e)):this.ls.removeItem(this._ttlKey(b));return this._safeSet(this._prefix(b),d(a))},remove:function(b){this.ls.removeItem(this._ttlKey(b));this.ls.removeItem(this._prefix(b));return this},clear:function(){var b=this.keyMatcher;var a,e,d=[],c=g.length;for(a=0;a<c;a++)(e=g.key(a)).match(b)&&d.push(e.replace(b,""));for(b=d.length;b--;)this.remove(d[b]);return this},isExpired:function(b){b=a.parseJSON(this.ls.getItem(this._ttlKey(b)));return c.isNumber(b)&&(new Date).getTime()>
b?!0:!1}});return f}(),r=function(){function f(b){b=b||{};this.cancelled=!1;this.lastReq=null;this._send=b.transport;this._get=b.limiter?b.limiter(this._get):this._get;this._cache=!1===b.cache?new h(0):m}var d=0,g={},b=6,m=new h(10);f.setMaxPendingRequests=function(e){b=e};f.resetCache=function(){m.reset()};c.mixin(f.prototype,{_fingerprint:function(b){b=b||{};return b.url+b.type+a.param(b.data||{})},_get:function(e,a){function c(b){a(null,b);t._cache.set(h,b)}function m(){a(!0)}function B(){d--;
delete g[h];t.onDeckRequestArgs&&(t._get.apply(t,t.onDeckRequestArgs),t.onDeckRequestArgs=null)}var t=this,f;var h=this._fingerprint(e);this.cancelled||h!==this.lastReq||((f=g[h])?f.done(c).fail(m):d<b?(d++,g[h]=this._send(e).done(c).fail(m).always(B)):this.onDeckRequestArgs=[].slice.call(arguments,0))},get:function(b,d){var e;d=d||a.noop;b=c.isString(b)?{url:b}:b||{};var g=this._fingerprint(b);this.cancelled=!1;this.lastReq=g;(e=this._cache.get(g))?d(null,e):this._get(b,d)},cancel:function(){this.cancelled=
!0}});return f}(),q=window.SearchIndex=function(){function f(b){b=b||{};b.datumTokenizer&&b.queryTokenizer||a.error("datumTokenizer and queryTokenizer are both required");this.identify=b.identify||c.stringify;this.datumTokenizer=b.datumTokenizer;this.queryTokenizer=b.queryTokenizer;this.reset()}function d(b){b=c.filter(b,function(b){return!!b});return b=c.map(b,function(b){return b.toLowerCase()})}function g(b){for(var a={},e=[],d=0,c=b.length;d<c;d++)a[b[d]]||(a[b[d]]=!0,e.push(b[d]));return e}c.mixin(f.prototype,
{bootstrap:function(b){this.datums=b.datums;this.trie=b.trie},add:function(b){var a=this;b=c.isArray(b)?b:[b];c.each(b,function(b){var e;a.datums[e=a.identify(b)]=b;b=d(a.datumTokenizer(b));c.each(b,function(b){var d;var c=a.trie;for(b=b.split("");d=b.shift();)c=c.c[d]||(c.c[d]={i:[],c:{}}),c.i.push(e)})})},get:function(b){var a=this;return c.map(b,function(b){return a.datums[b]})},search:function(b){var a=this,e;b=d(this.queryTokenizer(b));c.each(b,function(b){var d;if(e&&0===e.length)return!1;var c=
a.trie;for(b=b.split("");c&&(d=b.shift());)c=c.c[d];if(c&&0===b.length){d=c.i.slice(0);if(e){c=e;var g=b=0,m=[];c=c.sort();d=d.sort();for(var B=c.length,f=d.length;b<B&&g<f;)c[b]<d[g]?b++:(c[b]>d[g]||(m.push(c[b]),b++),g++);c=m}else c=d;e=c}else return e=[],!1});return e?c.map(g(e),function(b){return a.datums[b]}):[]},all:function(){var b=[],a;for(a in this.datums)b.push(this.datums[a]);return b},reset:function(){this.datums={};this.trie={i:[],c:{}}},serialize:function(){return{datums:this.datums,
trie:this.trie}}});return f}(),n=function(){function a(a){this.url=a.url;this.ttl=a.ttl;this.cache=a.cache;this.prepare=a.prepare;this.transform=a.transform;this.transport=a.transport;this.thumbprint=a.thumbprint;this.storage=new p(a.cacheKey)}c.mixin(a.prototype,{_settings:function(){return{url:this.url,type:"GET",dataType:"json"}},store:function(a){this.cache&&(this.storage.set("data",a,this.ttl),this.storage.set("protocol",location.protocol,this.ttl),this.storage.set("thumbprint",this.thumbprint,
this.ttl))},fromCache:function(){if(!this.cache)return null;var a=this.storage.get("data");var c=this.storage.get("protocol");c=this.storage.get("thumbprint")!==this.thumbprint||c!==location.protocol;return a&&!c?a:null},fromNetwork:function(a){var c=this;if(a){var b=this.prepare(this._settings());this.transport(b).fail(function(){a(!0)}).done(function(b){a(null,c.transform(b))})}},clear:function(){this.storage.clear();return this}});return a}(),y=function(){function a(a){this.url=a.url;this.prepare=
a.prepare;this.transform=a.transform;this.transport=new r({cache:a.cache,limiter:a.limiter,transport:a.transport})}c.mixin(a.prototype,{_settings:function(){return{url:this.url,type:"GET",dataType:"json"}},get:function(a,c){var b=this;if(c)return a=this.prepare(a||"",this._settings()),this.transport.get(a,function(a,e){a?c([]):c(b.transform(e))})},cancelLastRequest:function(){this.transport.cancel()}});return a}(),v=function(){function f(b){if(!b)return null;var e={url:null,ttl:864E5,cache:!0,cacheKey:null,
thumbprint:"",prepare:c.identity,transform:c.identity,transport:null};b=c.isString(b)?{url:b}:b;b=c.mixin(e,b);!b.url&&a.error("prefetch requires url to be set");b.transform=b.filter||b.transform;b.cacheKey=b.cacheKey||b.url;b.thumbprint="0.11.1"+b.thumbprint;b.transport=b.transport?m(b.transport):a.ajax;return b}function d(e){if(e){var d={url:null,cache:!0,prepare:null,replace:null,wildcard:null,limiter:null,rateLimitBy:"debounce",rateLimitWait:300,transform:c.identity,transport:null};e=c.isString(e)?
{url:e}:e;e=c.mixin(d,e);!e.url&&a.error("remote requires url to be set");e.transform=e.filter||e.transform;e.prepare=g(e);e.limiter=b(e);e.transport=e.transport?m(e.transport):a.ajax;delete e.replace;delete e.wildcard;delete e.rateLimitBy;delete e.rateLimitWait;return e}}function g(b){function a(b,a){a.url=g(a.url,b);return a}function c(b,a){a.url=a.url.replace(m,encodeURIComponent(b));return a}function e(b,a){return a}var d=b.prepare;var g=b.replace;var m=b.wildcard;return d?d:d=g?a:b.wildcard?
c:e}function b(b){function a(b){return function(a){return c.debounce(a,b)}}function e(b){return function(a){return c.throttle(a,b)}}var d=b.limiter;var g=b.rateLimitBy;b=b.rateLimitWait;d||(d=/^throttle$/i.test(g)?e(b):a(b));return d}function m(b){return function(e){var d=a.Deferred();b(e,function(b){c.defer(function(){d.resolve(b)})},function(b){c.defer(function(){d.reject(b)})});return d}}return function(b){b=c.mixin({initialize:!0,identify:c.stringify,datumTokenizer:null,queryTokenizer:null,sufficient:5,
sorter:null,local:[],prefetch:null,remote:null},b||{});!b.datumTokenizer&&a.error("datumTokenizer is required");!b.queryTokenizer&&a.error("queryTokenizer is required");var e=b.sorter;b.sorter=e?function(b){return b.sort(e)}:c.identity;b.local=c.isFunction(b.local)?b.local():b.local;b.prefetch=f(b.prefetch);b.remote=d(b.remote);return b}}();return function(){function h(a){a=v(a);this.sorter=a.sorter;this.identify=a.identify;this.sufficient=a.sufficient;this.local=a.local;this.remote=a.remote?new y(a.remote):
null;this.prefetch=a.prefetch?new n(a.prefetch):null;this.index=new q({identify:this.identify,datumTokenizer:a.datumTokenizer,queryTokenizer:a.queryTokenizer});!1!==a.initialize&&this.initialize()}var d=window&&window.Bloodhound;h.noConflict=function(){window&&(window.Bloodhound=d);return h};h.tokenizers=f;c.mixin(h.prototype,{__ttAdapter:function(){function a(b,a,d){return c.search(b,a,d)}function b(b,a){return c.search(b,a)}var c=this;return this.remote?a:b},_loadPrefetch:function(){function c(a,
c){if(a)return e.reject();b.add(c);b.prefetch.store(b.index.serialize());e.resolve()}var b=this,d;var e=a.Deferred();this.prefetch?(d=this.prefetch.fromCache())?(this.index.bootstrap(d),e.resolve()):this.prefetch.fromNetwork(c):e.resolve();return e.promise()},_initialize:function(){var a=this;this.clear();(this.initPromise=this._loadPrefetch()).done(function(){a.add(a.local)});return this.initPromise},initialize:function(a){return!this.initPromise||a?this._initialize():this.initPromise},add:function(a){this.index.add(a);
return this},get:function(a){a=c.isArray(a)?a:[].slice.call(arguments);return this.index.get(a)},search:function(a,b,d){function e(b){var a=[];c.each(b,function(b){!c.some(m,function(a){return g.identify(b)===g.identify(a)})&&a.push(b)});d&&d(a)}var g=this;var m=this.sorter(this.index.search(a));b(this.remote?m.slice():m);this.remote&&m.length<this.sufficient?this.remote.get(a,e):this.remote&&this.remote.cancelLastRequest();return this},all:function(){return this.index.all()},clear:function(){this.index.reset();
return this},clearPrefetchCache:function(){this.prefetch&&this.prefetch.clear();return this},clearRemoteCache:function(){r.resetCache();return this},ttAdapter:function(){return this.__ttAdapter()}});return h}()});
(function(a,c){"function"===typeof define&&define.amd?define("typeahead.js",["jquery"],function(a){return c(a)}):"object"===typeof exports?module.exports=c(require("jquery")):c(jQuery)})(this,function(a){var c=function(){return{isMsie:function(){return/(msie|trident)/i.test(navigator.userAgent)?navigator.userAgent.match(/(msie |rv:)(\d+(.\d+)?)/i)[2]:!1},isBlankString:function(a){return!a||/^\s*$/.test(a)},escapeRegExChars:function(a){return a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$\x26")},
isString:function(a){return"string"===typeof a},isNumber:function(a){return"number"===typeof a},isArray:a.isArray,isFunction:a.isFunction,isObject:a.isPlainObject,isUndefined:function(a){return"undefined"===typeof a},isElement:function(a){return!(!a||1!==a.nodeType)},isJQuery:function(c){return c instanceof a},toStr:function(a){return c.isUndefined(a)||null===a?"":a+""},bind:a.proxy,each:function(c,g){a.each(c,function(b,a){return g(a,b)})},map:a.map,filter:a.grep,every:function(c,g){var b=!0;if(!c)return b;
a.each(c,function(a,e){if(!(b=g.call(null,e,a,c)))return!1});return!!b},some:function(c,g){var b=!1;if(!c)return b;a.each(c,function(a,e){if(b=g.call(null,e,a,c))return!1});return!!b},mixin:a.extend,identity:function(a){return a},clone:function(c){return a.extend(!0,{},c)},getIdGenerator:function(){var a=0;return function(){return a++}},templatify:function(c){function d(){return String(c)}return a.isFunction(c)?c:d},defer:function(a){setTimeout(a,0)},debounce:function(a,c,b){var d,e;return function(){var g=
this,m=arguments;var f=b&&!d;clearTimeout(d);d=setTimeout(function(){d=null;b||(e=a.apply(g,m))},c);f&&(e=a.apply(g,m));return e}},throttle:function(a,c){var b,d,e,g;var f=0;var h=function(){f=new Date;e=null;g=a.apply(b,d)};return function(){var m=new Date,t=c-(m-f);b=this;d=arguments;0>=t?(clearTimeout(e),e=null,f=m,g=a.apply(b,d)):e||(e=setTimeout(h,t));return g}},stringify:function(a){return c.isString(a)?a:JSON.stringify(a)},noop:function(){}}}(),f=function(){function a(b){var a={};c.each(b,
function(b,c){a[c]="."+b});return a}function g(){var b={wrapper:{position:"relative",display:"inline-block"},hint:{position:"absolute",top:"0",left:"0",borderColor:"transparent",boxShadow:"none",opacity:"1"},input:{position:"relative",verticalAlign:"top",backgroundColor:"transparent"},inputWithNoHint:{position:"relative",verticalAlign:"top"},menu:{position:"absolute",top:"100%",left:"0",zIndex:"100",display:"none"},ltr:{left:"0",right:"auto"},rtl:{left:"auto",right:" 0"}};c.isMsie()&&c.mixin(b.input,
{backgroundImage:"url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)"});return b}var b={wrapper:"twitter-typeahead",input:"tt-input",hint:"tt-hint",menu:"tt-menu",dataset:"tt-dataset",suggestion:"tt-suggestion",selectable:"tt-selectable",empty:"tt-empty",open:"tt-open",cursor:"tt-cursor",highlight:"tt-highlight"};return function(d){d=c.mixin({},b,d);var e={css:g(),classes:d,html:{wrapper:'\x3cspan class\x3d"'+d.wrapper+'"\x3e\x3c/span\x3e',menu:'\x3cdiv class\x3d"'+
d.menu+'"\x3e\x3c/div\x3e'},selectors:a(d)};return{css:e.css,html:e.html,classes:e.classes,selectors:e.selectors,mixin:function(b){c.mixin(b,e)}}}}(),h=function(){function d(b){b&&b.el||a.error("EventBus initialized without el");this.$el=a(b.el)}var g={render:"rendered",cursorchange:"cursorchanged",select:"selected",autocomplete:"autocompleted"};c.mixin(d.prototype,{_trigger:function(b,c){b=a.Event("typeahead:"+b);(c=c||[]).unshift(b);this.$el.trigger.apply(this.$el,c);return b},before:function(b){var a=
[].slice.call(arguments,1);return this._trigger("before"+b,a).isDefaultPrevented()},trigger:function(b){var a;this._trigger(b,[].slice.call(arguments,1));(a=g[b])&&this._trigger(a,[].slice.call(arguments,1))}});return d}(),p=function(){function a(a,c,e,d){if(!e)return this;c=c.split(m);e=d?b(e,d):e;for(this._callbacks=this._callbacks||{};d=c.shift();)this._callbacks[d]=this._callbacks[d]||{sync:[],async:[]},this._callbacks[d][a].push(e);return this}function c(b,a,c){return function(){for(var e,d=
0,g=b.length;!e&&d<g;d+=1)e=!1===b[d].apply(a,c);return!e}}function b(b,a){return b.bind?b.bind(a):function(){b.apply(a,[].slice.call(arguments,0))}}var m=/\s+/,e=function(){return window.setImmediate?function(b){setImmediate(function(){b()})}:function(b){setTimeout(function(){b()},0)}}();return{onSync:function(b,c,e){return a.call(this,"sync",b,c,e)},onAsync:function(b,c,e){return a.call(this,"async",b,c,e)},off:function(b){var a;if(!this._callbacks)return this;for(b=b.split(m);a=b.shift();)delete this._callbacks[a];
return this},trigger:function(b){var a,d,g;if(!this._callbacks)return this;b=b.split(m);for(g=[].slice.call(arguments,1);(a=b.shift())&&(d=this._callbacks[a]);){var f=c(d.sync,this,[a].concat(g));var B=c(d.async,this,[a].concat(g));f()&&e(B)}return this}}}(),r=function(a){function d(b,a,d){for(var e=[],g=0,m=b.length;g<m;g++)e.push(c.escapeRegExChars(b[g]));b=d?"\\b("+e.join("|")+")\\b":"("+e.join("|")+")";return a?new RegExp(b):new RegExp(b,"i")}var b={node:null,pattern:null,tagName:"strong",className:null,
wordsOnly:!1,caseSensitive:!1};return function(g){function e(b,a){for(var c,d=0;d<b.childNodes.length;d++)c=b.childNodes[d],3===c.nodeType?d+=a(c)?1:0:e(c,a)}g=c.mixin({},b,g);if(g.node&&g.pattern){g.pattern=c.isArray(g.pattern)?g.pattern:[g.pattern];var m=d(g.pattern,g.caseSensitive,g.wordsOnly);e(g.node,function(b){var c;if(c=m.exec(b.data)){var e=a.createElement(g.tagName);g.className&&(e.className=g.className);var d=b.splitText(c.index);d.splitText(c[0].length);e.appendChild(d.cloneNode(!0));
b.parentNode.replaceChild(e,d)}return!!c})}}}(window.document),q=function(){function d(b,d){b=b||{};b.input||a.error("input is missing");d.mixin(this);this.$hint=a(b.hint);this.$input=a(b.input);this.query=this.$input.val();this.queryWhenFocused=this.hasFocus()?this.query:null;b=this.$input;this.$overflowHelper=a('\x3cpre aria-hidden\x3d"true"\x3e\x3c/pre\x3e').css({position:"absolute",visibility:"hidden",whiteSpace:"pre",fontFamily:b.css("font-family"),fontSize:b.css("font-size"),fontStyle:b.css("font-style"),
fontVariant:b.css("font-variant"),fontWeight:b.css("font-weight"),wordSpacing:b.css("word-spacing"),letterSpacing:b.css("letter-spacing"),textIndent:b.css("text-indent"),textRendering:b.css("text-rendering"),textTransform:b.css("text-transform")}).insertAfter(b);this._checkLanguageDirection();0===this.$hint.length&&(this.setHint=this.getHint=this.clearHint=this.clearHintIfInvalid=c.noop)}var g={9:"tab",27:"esc",37:"left",39:"right",13:"enter",38:"up",40:"down"};d.normalizeQuery=function(b){return c.toStr(b).replace(/^\s*/g,
"").replace(/\s{2,}/g," ")};c.mixin(d.prototype,p,{_onBlur:function(){this.resetInputValue();this.trigger("blurred")},_onFocus:function(){this.queryWhenFocused=this.query;this.trigger("focused")},_onKeydown:function(b){var a=g[b.which||b.keyCode];this._managePreventDefault(a,b);a&&this._shouldTrigger(a,b)&&this.trigger(a+"Keyed",b)},_onInput:function(){this._setQuery(this.getInputValue());this.clearHintIfInvalid();this._checkLanguageDirection()},_managePreventDefault:function(b,a){switch(b){case "up":case "down":b=
!(a.altKey||a.ctrlKey||a.metaKey||a.shiftKey);break;default:b=!1}b&&a.preventDefault()},_shouldTrigger:function(b,a){switch(b){case "tab":b=!(a.altKey||a.ctrlKey||a.metaKey||a.shiftKey);break;default:b=!0}return b},_checkLanguageDirection:function(){var b=(this.$input.css("direction")||"ltr").toLowerCase();this.dir!==b&&(this.dir=b,this.$hint.attr("dir",b),this.trigger("langDirChanged",b))},_setQuery:function(b,a){var c=this.query;var g=(c=d.normalizeQuery(b)===d.normalizeQuery(c))?this.query.length!==
b.length:!1;this.query=b;a||c?!a&&g&&this.trigger("whitespaceChanged",this.query):this.trigger("queryChanged",this.query)},bind:function(){var b=this;var a=c.bind(this._onBlur,this);var e=c.bind(this._onFocus,this);var d=c.bind(this._onKeydown,this);var f=c.bind(this._onInput,this);this.$input.on("blur.tt",a).on("focus.tt",e).on("keydown.tt",d);if(!c.isMsie()||9<c.isMsie())this.$input.on("input.tt",f);else this.$input.on("keydown.tt keypress.tt cut.tt paste.tt",function(a){g[a.which||a.keyCode]||
c.defer(c.bind(b._onInput,b,a))});return this},focus:function(){this.$input.focus()},blur:function(){this.$input.blur()},getLangDir:function(){return this.dir},getQuery:function(){return this.query||""},setQuery:function(b,a){this.setInputValue(b);this._setQuery(b,a)},hasQueryChangedSinceLastFocus:function(){return this.query!==this.queryWhenFocused},getInputValue:function(){return this.$input.val()},setInputValue:function(b){this.$input.val(b);this.clearHintIfInvalid();this._checkLanguageDirection()},
resetInputValue:function(){this.setInputValue(this.query)},getHint:function(){return this.$hint.val()},setHint:function(b){this.$hint.val(b)},clearHint:function(){this.setHint("")},clearHintIfInvalid:function(){var b=this.getInputValue();var a=this.getHint();a=b!==a&&0===a.indexOf(b);""!==b&&a&&!this.hasOverflow()||this.clearHint()},hasFocus:function(){return this.$input.is(":focus")},hasOverflow:function(){var b=this.$input.width()-2;this.$overflowHelper.text(this.getInputValue());return this.$overflowHelper.width()>=
b},isCursorAtEnd:function(){var b=this.$input.val().length;var a=this.$input[0].selectionStart;return c.isNumber(a)?a===b:document.selection?(a=document.selection.createRange(),a.moveStart("character",-b),b===a.text.length):!0},destroy:function(){this.$hint.off(".tt");this.$input.off(".tt");this.$overflowHelper.remove();this.$hint=this.$input=this.$overflowHelper=a("\x3cdiv\x3e")}});return d}(),n=function(){function d(e,d){e=e||{};e.templates=e.templates||{};e.templates.notFound=e.templates.notFound||
e.templates.empty;e.source||a.error("missing source");e.node||a.error("missing node");e.name&&!/^[_a-zA-Z0-9-]+$/.test(e.name)&&a.error("invalid dataset name: "+e.name);d.mixin(this);this.highlight=!!e.highlight;this.name=e.name||f();this.limit=e.limit||5;this.displayFn=g(e.display||e.displayKey);this.templates=b(e.templates,this.displayFn);this.source=e.source.__ttAdapter?e.source.__ttAdapter():e.source;this.async=c.isUndefined(e.async)?2<this.source.length:!!e.async;this._resetLastSuggestion();
this.$el=a(e.node).addClass(this.classes.dataset).addClass(this.classes.dataset+"-"+this.name)}function g(b){function a(a){return a[b]}b=b||c.stringify;return c.isFunction(b)?b:a}function b(b,d){function e(b){return a("\x3cdiv\x3e").text(d(b))}return{notFound:b.notFound&&c.templatify(b.notFound),pending:b.pending&&c.templatify(b.pending),header:b.header&&c.templatify(b.header),footer:b.footer&&c.templatify(b.footer),suggestion:b.suggestion||e}}var f=c.getIdGenerator();d.extractData=function(b){b=
a(b);return b.data("tt-selectable-object")?{val:b.data("tt-selectable-display")||"",obj:b.data("tt-selectable-object")||null}:null};c.mixin(d.prototype,p,{_overwrite:function(b,a){a=a||[];a.length?this._renderSuggestions(b,a):this.async&&this.templates.pending?this._renderPending(b):!this.async&&this.templates.notFound?this._renderNotFound(b):this._empty();this.trigger("rendered",this.name,a,!1)},_append:function(b,a){a=a||[];a.length&&this.$lastSuggestion.length?this._appendSuggestions(b,a):a.length?
this._renderSuggestions(b,a):!this.$lastSuggestion.length&&this.templates.notFound&&this._renderNotFound(b);this.trigger("rendered",this.name,a,!0)},_renderSuggestions:function(b,a){var c=this._getSuggestionsFragment(b,a);this.$lastSuggestion=c.children().last();this.$el.html(c).prepend(this._getHeader(b,a)).append(this._getFooter(b,a))},_appendSuggestions:function(b,a){b=this._getSuggestionsFragment(b,a);a=b.children().last();this.$lastSuggestion.after(b);this.$lastSuggestion=a},_renderPending:function(b){var a=
this.templates.pending;this._resetLastSuggestion();a&&this.$el.html(a({query:b,dataset:this.name}))},_renderNotFound:function(b){var a=this.templates.notFound;this._resetLastSuggestion();a&&this.$el.html(a({query:b,dataset:this.name}))},_empty:function(){this.$el.empty();this._resetLastSuggestion()},_getSuggestionsFragment:function(b,d){var e=this;var g=document.createDocumentFragment();c.each(d,function(c){var d=e._injectQuery(b,c);c=a(e.templates.suggestion(d)).data("tt-selectable-object",c).data("tt-selectable-display",
e.displayFn(c)).addClass(e.classes.suggestion+" "+e.classes.selectable);g.appendChild(c[0])});this.highlight&&r({className:this.classes.highlight,node:g,pattern:b});return a(g)},_getFooter:function(b,a){return this.templates.footer?this.templates.footer({query:b,suggestions:a,dataset:this.name}):null},_getHeader:function(b,a){return this.templates.header?this.templates.header({query:b,suggestions:a,dataset:this.name}):null},_resetLastSuggestion:function(){this.$lastSuggestion=a()},_injectQuery:function(b,
a){return c.isObject(a)?c.mixin({_query:b},a):a},update:function(b){function c(a){g||(g=!0,a=(a||[]).slice(0,d.limit),f=a.length,d._overwrite(b,a),f<d.limit&&d.async&&d.trigger("asyncRequested",b))}var d=this,e=!1,g=!1,f=0;this.cancel();this.cancel=function(){e=!0;d.cancel=a.noop;d.async&&d.trigger("asyncCanceled",b)};this.source(b,c,function(c){c=c||[];!e&&f<d.limit&&(d.cancel=a.noop,f+=c.length,d._append(b,c.slice(0,d.limit-f)),d.async&&d.trigger("asyncReceived",b))});!g&&c([])},cancel:a.noop,clear:function(){this._empty();
this.cancel();this.trigger("cleared")},isEmpty:function(){return this.$el.is(":empty")},destroy:function(){this.$el=a("\x3cdiv\x3e")}});return d}(),y=function(){function d(d,b){var g=this;d=d||{};d.node||a.error("node is required");b.mixin(this);this.$node=a(d.node);this.query=null;this.datasets=c.map(d.datasets,function(c){var d=g.$node.find(c.node).first();c.node=d.length?d:a("\x3cdiv\x3e").appendTo(g.$node);return new n(c,b)})}c.mixin(d.prototype,p,{_onSelectableClick:function(c){this.trigger("selectableClicked",
a(c.currentTarget))},_onRendered:function(a,b,c,d){this.$node.toggleClass(this.classes.empty,this._allDatasetsEmpty());this.trigger("datasetRendered",b,c,d)},_onCleared:function(){this.$node.toggleClass(this.classes.empty,this._allDatasetsEmpty());this.trigger("datasetCleared")},_propagate:function(){this.trigger.apply(this,arguments)},_allDatasetsEmpty:function(){return c.every(this.datasets,function(a){return a.isEmpty()})},_getSelectables:function(){return this.$node.find(this.selectors.selectable)},
_removeCursor:function(){var a=this.getActiveSelectable();a&&a.removeClass(this.classes.cursor)},_ensureVisible:function(a){var b=a.position().top;a=b+a.outerHeight(!0);var c=this.$node.scrollTop();var d=this.$node.height()+parseInt(this.$node.css("paddingTop"),10)+parseInt(this.$node.css("paddingBottom"),10);0>b?this.$node.scrollTop(c+b):d<a&&this.$node.scrollTop(c+(a-d))},bind:function(){var a=this;var b=c.bind(this._onSelectableClick,this);this.$node.on("click.tt",this.selectors.selectable,b);
c.each(this.datasets,function(b){b.onSync("asyncRequested",a._propagate,a).onSync("asyncCanceled",a._propagate,a).onSync("asyncReceived",a._propagate,a).onSync("rendered",a._onRendered,a).onSync("cleared",a._onCleared,a)});return this},isOpen:function(){return this.$node.hasClass(this.classes.open)},open:function(){this.$node.addClass(this.classes.open)},close:function(){this.$node.removeClass(this.classes.open);this._removeCursor()},setLanguageDirection:function(a){this.$node.attr("dir",a)},selectableRelativeToCursor:function(a){var b=
this.getActiveSelectable();var c=this._getSelectables();a=((b?c.index(b):-1)+a+1)%(c.length+1)-1;a=-1>a?c.length-1:a;return-1===a?null:c.eq(a)},setCursor:function(a){this._removeCursor();if(a=a&&a.first())a.addClass(this.classes.cursor),this._ensureVisible(a)},getSelectableData:function(a){return a&&a.length?n.extractData(a):null},getActiveSelectable:function(){var a=this._getSelectables().filter(this.selectors.cursor).first();return a.length?a:null},getTopSelectable:function(){var a=this._getSelectables().first();
return a.length?a:null},update:function(a){function b(b){b.update(a)}var d=a!==this.query;d&&(this.query=a,c.each(this.datasets,b));return d},empty:function(){c.each(this.datasets,function(a){a.clear()});this.query=null;this.$node.addClass(this.classes.empty)},destroy:function(){this.$node.off(".tt");this.$node=a("\x3cdiv\x3e");c.each(this.datasets,function(a){a.destroy()})}});return d}(),v=function(){function a(){y.apply(this,[].slice.call(arguments,0))}var g=y.prototype;c.mixin(a.prototype,y.prototype,
{open:function(){!this._allDatasetsEmpty()&&this._show();return g.open.apply(this,[].slice.call(arguments,0))},close:function(){this._hide();return g.close.apply(this,[].slice.call(arguments,0))},_onRendered:function(){this._allDatasetsEmpty()?this._hide():this.isOpen()&&this._show();return g._onRendered.apply(this,[].slice.call(arguments,0))},_onCleared:function(){this._allDatasetsEmpty()?this._hide():this.isOpen()&&this._show();return g._onCleared.apply(this,[].slice.call(arguments,0))},setLanguageDirection:function(a){this.$node.css("ltr"===
a?this.css.ltr:this.css.rtl);return g.setLanguageDirection.apply(this,[].slice.call(arguments,0))},_hide:function(){this.$node.hide()},_show:function(){this.$node.css("display","block")}});return a}(),x=function(){function d(b,d){b=b||{};b.input||a.error("missing input");b.menu||a.error("missing menu");b.eventBus||a.error("missing event bus");d.mixin(this);this.eventBus=b.eventBus;this.minLength=c.isNumber(b.minLength)?b.minLength:1;this.input=b.input;this.menu=b.menu;this.enabled=!0;this.active=
!1;this.input.hasFocus()&&this.activate();this.dir=this.input.getLangDir();this._hacks();this.menu.bind().onSync("selectableClicked",this._onSelectableClicked,this).onSync("asyncRequested",this._onAsyncRequested,this).onSync("asyncCanceled",this._onAsyncCanceled,this).onSync("asyncReceived",this._onAsyncReceived,this).onSync("datasetRendered",this._onDatasetRendered,this).onSync("datasetCleared",this._onDatasetCleared,this);b=g(this,"activate","open","_onFocused");d=g(this,"deactivate","_onBlurred");
var e=g(this,"isActive","isOpen","_onEnterKeyed");var f=g(this,"isActive","isOpen","_onTabKeyed");var m=g(this,"isActive","_onEscKeyed");var h=g(this,"isActive","open","_onUpKeyed");var l=g(this,"isActive","open","_onDownKeyed");var t=g(this,"isActive","isOpen","_onLeftKeyed");var r=g(this,"isActive","isOpen","_onRightKeyed");var q=g(this,"_openIfActive","_onQueryChanged");var p=g(this,"_openIfActive","_onWhitespaceChanged");this.input.bind().onSync("focused",b,this).onSync("blurred",d,this).onSync("enterKeyed",
e,this).onSync("tabKeyed",f,this).onSync("escKeyed",m,this).onSync("upKeyed",h,this).onSync("downKeyed",l,this).onSync("leftKeyed",t,this).onSync("rightKeyed",r,this).onSync("queryChanged",q,this).onSync("whitespaceChanged",p,this).onSync("langDirChanged",this._onLangDirChanged,this)}function g(a){var b=[].slice.call(arguments,1);return function(){var d=[].slice.call(arguments);c.each(b,function(b){return a[b].apply(a,d)})}}c.mixin(d.prototype,{_hacks:function(){var b=this.input.$input||a("\x3cdiv\x3e");
var d=this.menu.$node||a("\x3cdiv\x3e");b.on("blur.tt",function(a){var e=document.activeElement;var g=d.is(e);e=0<d.has(e).length;c.isMsie()&&(g||e)&&(a.preventDefault(),a.stopImmediatePropagation(),c.defer(function(){b.focus()}))});d.on("mousedown.tt",function(a){a.preventDefault()})},_onSelectableClicked:function(a,c){this.select(c)},_onDatasetCleared:function(){this._updateHint()},_onDatasetRendered:function(a,c,d,g){this._updateHint();this.eventBus.trigger("render",d,g,c)},_onAsyncRequested:function(a,
c,d){this.eventBus.trigger("asyncrequest",d,c)},_onAsyncCanceled:function(a,c,d){this.eventBus.trigger("asynccancel",d,c)},_onAsyncReceived:function(a,c,d){this.eventBus.trigger("asyncreceive",d,c)},_onFocused:function(){this._minLengthMet()&&this.menu.update(this.input.getQuery())},_onBlurred:function(){this.input.hasQueryChangedSinceLastFocus()&&this.eventBus.trigger("change",this.input.getQuery())},_onEnterKeyed:function(a,c){var b;(b=this.menu.getActiveSelectable())&&this.select(b)&&c.preventDefault()},
_onTabKeyed:function(a,c){var b;(b=this.menu.getActiveSelectable())?this.select(b)&&c.preventDefault():(b=this.menu.getTopSelectable())&&this.autocomplete(b)&&c.preventDefault()},_onEscKeyed:function(){this.close()},_onUpKeyed:function(){this.moveCursor(-1)},_onDownKeyed:function(){this.moveCursor(1)},_onLeftKeyed:function(){"rtl"===this.dir&&this.input.isCursorAtEnd()&&this.autocomplete(this.menu.getTopSelectable())},_onRightKeyed:function(){"ltr"===this.dir&&this.input.isCursorAtEnd()&&this.autocomplete(this.menu.getTopSelectable())},
_onQueryChanged:function(a,c){this._minLengthMet(c)?this.menu.update(c):this.menu.empty()},_onWhitespaceChanged:function(){this._updateHint()},_onLangDirChanged:function(a,c){this.dir!==c&&(this.dir=c,this.menu.setLanguageDirection(c))},_openIfActive:function(){this.isActive()&&this.open()},_minLengthMet:function(a){a=c.isString(a)?a:this.input.getQuery()||"";return a.length>=this.minLength},_updateHint:function(){var a=this.menu.getTopSelectable();var d=this.menu.getSelectableData(a);a=this.input.getInputValue();
if(!d||c.isBlankString(a)||this.input.hasOverflow())this.input.clearHint();else{var e=q.normalizeQuery(a);e=c.escapeRegExChars(e);e=new RegExp("^(?:"+e+")(.+$)","i");(d=e.exec(d.val))&&this.input.setHint(a+d[1])}},isEnabled:function(){return this.enabled},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},isActive:function(){return this.active},activate:function(){if(this.isActive())return!0;if(!this.isEnabled()||this.eventBus.before("active"))return!1;this.active=!0;this.eventBus.trigger("active");
return!0},deactivate:function(){if(this.isActive()){if(this.eventBus.before("idle"))return!1;this.active=!1;this.close();this.eventBus.trigger("idle")}return!0},isOpen:function(){return this.menu.isOpen()},open:function(){this.isOpen()||this.eventBus.before("open")||(this.menu.open(),this._updateHint(),this.eventBus.trigger("open"));return this.isOpen()},close:function(){this.isOpen()&&!this.eventBus.before("close")&&(this.menu.close(),this.input.clearHint(),this.input.resetInputValue(),this.eventBus.trigger("close"));
return!this.isOpen()},setVal:function(a){this.input.setQuery(c.toStr(a))},getVal:function(){return this.input.getQuery()},select:function(a){return(a=this.menu.getSelectableData(a))&&!this.eventBus.before("select",a.obj)?(this.input.setQuery(a.val,!0),this.eventBus.trigger("select",a.obj),this.close(),!0):!1},autocomplete:function(a){var b=this.input.getQuery();return(a=this.menu.getSelectableData(a))&&b!==a.val&&!this.eventBus.before("autocomplete",a.obj)?(this.input.setQuery(a.val),this.eventBus.trigger("autocomplete",
a.obj),!0):!1},moveCursor:function(a){var b;var c=this.input.getQuery();a=this.menu.selectableRelativeToCursor(a);var d=(b=this.menu.getSelectableData(a))?b.obj:null;return this._minLengthMet()&&this.menu.update(c)||this.eventBus.before("cursorchange",d)?!1:(this.menu.setCursor(a),b?this.input.setInputValue(b.val):(this.input.resetInputValue(),this._updateHint()),this.eventBus.trigger("cursorchange",d),!0)},destroy:function(){this.input.destroy();this.menu.destroy()}});return d}();(function(){function d(b,
c){b.each(function(){var b=a(this),d;(d=b.data(n.typeahead))&&c(d,b)})}function g(a,b){return a.clone().addClass(b.classes.hint).removeData().css(b.css.hint).css(m(a)).prop("readonly",!0).removeAttr("id name placeholder required").attr({autocomplete:"off",spellcheck:"false",tabindex:-1})}function b(a,b){a.data(n.attrs,{dir:a.attr("dir"),autocomplete:a.attr("autocomplete"),spellcheck:a.attr("spellcheck"),style:a.attr("style")});a.addClass(b.classes.input).attr({autocomplete:"off",spellcheck:!1});try{!a.attr("dir")&&
a.attr("dir","auto")}catch(z){}return a}function m(a){return{backgroundAttachment:a.css("background-attachment"),backgroundClip:a.css("background-clip"),backgroundColor:a.css("background-color"),backgroundImage:a.css("background-image"),backgroundOrigin:a.css("background-origin"),backgroundPosition:a.css("background-position"),backgroundRepeat:a.css("background-repeat"),backgroundSize:a.css("background-size")}}function e(a){var b=a.data(n.www);var d=a.parent().filter(b.selectors.wrapper);c.each(a.data(n.attrs),
function(b,d){c.isUndefined(b)?a.removeAttr(d):a.attr(d,b)});a.removeData(n.typeahead).removeData(n.www).removeData(n.attr).removeClass(b.classes.input);d.length&&(a.detach().insertAfter(d),d.remove())}function r(b){b=c.isJQuery(b)||c.isElement(b)?a(b).first():[];return b.length?b:null}var p=a.fn.typeahead;var n={www:"tt-www",attrs:"tt-attrs",typeahead:"tt-typeahead"};var l={initialize:function(d,e){e=c.isArray(e)?e:[].slice.call(arguments,1);d=d||{};var m=f(d.classNames);return this.each(function(){c.each(e,
function(a){a.highlight=!!d.highlight});var f=a(this);var t=a(m.html.wrapper);var l=r(d.hint);var p=r(d.menu);var w=!1!==d.hint&&!l;var B=!1!==d.menu&&!p;w&&(l=g(f,m));B&&(p=a(m.html.menu).css(m.css.menu));l&&l.val("");f=b(f,m);if(w||B)t.css(m.css.wrapper),f.css(w?m.css.input:m.css.inputWithNoHint),f.wrap(t).parent().prepend(w?l:null).append(B?p:null);w=B?v:y;t=new h({el:f});l=new q({hint:l,input:f},m);p=new w({node:p,datasets:e},m);p=new x({input:l,menu:p,eventBus:t,minLength:d.minLength},m);f.data(n.www,
m);f.data(n.typeahead,p)})},isEnabled:function(){var a;d(this.first(),function(b){a=b.isEnabled()});return a},enable:function(){d(this,function(a){a.enable()});return this},disable:function(){d(this,function(a){a.disable()});return this},isActive:function(){var a;d(this.first(),function(b){a=b.isActive()});return a},activate:function(){d(this,function(a){a.activate()});return this},deactivate:function(){d(this,function(a){a.deactivate()});return this},isOpen:function(){var a;d(this.first(),function(b){a=
b.isOpen()});return a},open:function(){d(this,function(a){a.open()});return this},close:function(){d(this,function(a){a.close()});return this},select:function(b){var c=!1,e=a(b);d(this.first(),function(a){c=a.select(e)});return c},autocomplete:function(b){var c=!1,e=a(b);d(this.first(),function(a){c=a.autocomplete(e)});return c},moveCursor:function(a){var b=!1;d(this.first(),function(c){b=c.moveCursor(a)});return b},val:function(a){var b;if(arguments.length)return d(this,function(b){b.setVal(a)}),
this;d(this.first(),function(a){b=a.getVal()});return b},destroy:function(){d(this,function(a,b){e(b);a.destroy()});return this}};a.fn.typeahead=function(a){return l[a]?l[a].apply(this,[].slice.call(arguments,1)):l.initialize.apply(this,arguments)};a.fn.typeahead.noConflict=function(){a.fn.typeahead=p;return this}})()});
function cityList(){function a(a){var c;for(c=a.indexOf("\x26#");-1!=c;){var f=a.indexOf(";");c=a.substring(c,f+1);f=c.replace(/&#/,"");f=f.replace(/;/,"");f=String.fromCharCode(f);a=a.replace(c,f);c=a.indexOf("\x26#")}return a}var c=$("#page-locale").val(),f=[];c=0<$(".fifa-shuttle-enabled").length?"/content/dam/Qatar/fifa-citylist.json":"/content/Qatar/common/cityLists/citylists/cityList_"+c+".json";$.ajax({url:c,dataType:"json",async:!1,success:function(c){$.each(c,function(c,h){c=a(h.city);var q=
a(h.airport),n=a(h.shorthand),p=a(h.country),r=a(h.countryCode),x=a(h.priority);f.push({city:c,shorthand:n,airport:q,country:p,countryCode:r,priority:x,latitude:h.latitude,longitude:h.longitude,video:h.video,map:h.map,squareImage:h.squareImage,horizontal2Image:h.horizontal2Image,railStation:h.railStation,busStation:h.busStation})});window.cityListJSON=f}});"function"===typeof nearestAirport&&nearestAirport()}
$(document).ready(function(a){var c=!1;if("IntersectionObserver"in window){a=new IntersectionObserver(function(a,f){a.forEach(function(f){0<f.intersectionRatio&&$.each(a,function(a,f){$("#bw-from").click(function(){if("undefined"==window.callJson&&!c||!window.callJson)cityList(),$("#bw-from:visible,#bw-to:visible",".bw-autocomplete").bwAutocomplete(),c=!0,window.callJson=!0})})})});var f=document.querySelector(".bw-autocomplete-suggestion");null!=f&&a.observe(f)}else $("#bw-from").click(function(){if("undefined"==
window.callJson&&!c||!window.callJson)cityList(),$("#bw-from:visible,#bw-to:visible",".bw-autocomplete").bwAutocomplete(),c=!0,window.callJson=!0})});var emdAnalyticsevent=!0,enableTrendingDest=!1,autoFromCountrycode="",isTrending=!1,pagePathVal=$("#page-path").val();-1!=pagePathVal.indexOf("/homepage")&&"undefined"!=typeof trendingDests&&(enableTrendingDest=!0);
var awardBookShown=!1,cashplusmilesShown=!1,showAwardBook=null!=getFFPCookieValue("QRTOKEN")&&""!=getFFPCookieValue("QRTOKEN")&&void 0!=getFFPCookieValue("QRTOKEN")&&"QRPC"==getUserBasicInfoField("programCode"),qmilesVal="true"==$("#bookFlight-config").attr("data-enable-award-book")&&showAwardBook?getUserBasicInfoField("qmilesAmount"):0,bwbxtdEventMap=new Map,bwtdViewEvents=[],bxBWTDViewed=!1,customJsonFlag=!1,fromToCountryJson1,trenddestHtml="",closestDestHtml="",alllocation="",totalsuggestions=
"";Array.prototype.insert=function(a,c){this.splice.apply(this,[a,0].concat(c))};var customFromIataCodes;function updateBXEventMap(){if(enableTrendingDest&&0<trendingDests.length)for(var a=0;a<trendingDests.length;a++)bwbxtdEventMap.set(trendingDests[a],"HPBW_TD_"+trendingDests[a]+"_POS"+a+"_HPBWTD-VIEWED"),bwtdViewEvents.push("HPBW_TD_"+trendingDests[a]+"_POS"+a+"_HPBWTD-VIEWED")}
function bxBWTDEvents(){if(!bxBWTDViewed){for(var a=0;a<bwtdViewEvents.length;a++)sendBXTrackingEventNew(bwtdViewEvents[a]);bxBWTDViewed=!0}}
$(function(){function a(a){var c="flyCity";"Y"==a.railStation?c="railCity":"Y"==a.busStation&&(c="busCity");return c}function c(a){var c=a.closest(".tt-menu");a.closest(".flightfrom").length&&("none"==c.find(".tt-dataset-current .tt-suggestion").css("display")?c.find(".tt-dataset-current h3").css("display","none"):c.find(".tt-dataset-current").find("h3").css("display","block"));a.closest(".flightto").length&&(c.find(".tt-dataset-trenddest h3").css("display","none"),c.find(".tt-dataset-trenddest .tt-suggestion").each(function(){"block"==
$(this).css("display")&&c.find(".tt-dataset-trenddest h3").css("display","block")}))}$.fn.bwAutocomplete=function(){function c(a){return function(c,g){var b=[],d="",e=[],f=0,h=[],x=0,l=$(this.$el[0].parentElement.parentElement).closest(".bw-autocomplete").find("label").attr("for");if("flightStatusFrom"==l){var t=$("#"+l).val(),w=/^[0-9]{1,6}$/,z=/^[QR,qr]{2}[0-9]{1,6}$/,A=/^[QR,qr]{2}[\-\s][0-9]{1,6}$/,C=t.substr(0,2);if("00"==C)var G=C;/^[QR,qr]{2}$/.test(C)||(C=parseInt(C));var H=/^[0-9]{2}$/,I=
t.substr(0,1);if(1==t.length&&!isNaN(I)||0<t.length&&(w.test(t)||z.test(t)||A.test(t))&&("QR"==C||"qr"==C||"Qr"==C||"qR"==C||H.test(C)||"00"==G))return $("#"+l).next(".tt-menu").removeClass("tt-open"),$("#"+l).parents(".twitter-typeahead").find(".tt-menu").removeClass("tt-open").addClass("tt-empty"),$(".twitter-typeahead").find(".tt-menu").css("display","none"),$(".twitter-typeahead").find(".tt-menu .tt-dataset").empty(),!1}if(void 0!=a)var K=a.length;$.each(a,function(a,b){a=b.city+"|"+b.airport+
"|"+b.shorthand+"|"+(""!=b.cityCode?b.cityCode:"")+"|"+b.country+"|"+b.countryCode+"|"+b.priority;""==$("#"+l).val()?"Y"==b.busStation?(h[x]=[a,b.video,b.map,b.railStation,b.busStation],x++):"Y"==b.railStation?(h[x]=[a,b.video,b.map,b.railStation,b.busStation],x++):(e[f]=[a,b.video,b.map,b.railStation,b.busStation],f++):(e[f]=[a,b.video,b.map,b.railStation,b.busStation],f++)});c=-1!=c.lastIndexOf(" ")?c.substring(0,c.lastIndexOf(" ")-1):c;var Y=/qr$/i,L=$.grep(e,function(a){return Y.test(a[0])}),
Z=new RegExp("^"+c+"|\\|"+c+"|\\/"+c+"|\\*"+c,"i");t=$.grep(L,function(a){return Z.test(a[0])});var aa=new RegExp("\\b"+c+"\\|\\b","i"),T=$.grep(t,function(a){return aa.test(a[0])}),S=new RegExp("^"+c,"i"),U=$.grep(L,function(a){return 0>$.inArray(a,T)&&S.test(a[0])}),ba=new RegExp(c,"i");t=$.grep(t,function(a){return 0>$.inArray(a,T)&&0>$.inArray(a,U)&&ba.test(a[0])});var ca=/ow$/i;w=$.grep(e,function(a){return ca.test(a[0])});$.grep(w,function(a){return S.test(a[0])&&0>$.inArray(a,L)});var da=new RegExp("^"+
c+"|\\|"+c+"|\\/"+c+"|\\*"+c,"i");w=$.grep(w,function(a){return da.test(a[0])&&0>$.inArray(a,L)});var ea=new RegExp("\\b"+c+"\\|\\b","i"),V=$.grep(w,function(a){return ea.test(a[0])}),fa=new RegExp(c,"i");w=$.grep(w,function(a){return 0>$.inArray(a,V)&&fa.test(a[0])});var ha=/cs$/i;z=$.grep(e,function(a){return ha.test(a[0])});$.grep(z,function(a){return S.test(a[0])&&0>$.inArray(a,L)});var ia=new RegExp("^"+c+"|\\|"+c+"|\\/"+c+"|\\*"+c,"i");z=$.grep(z,function(a){return ia.test(a[0])&&0>$.inArray(a,
L)});var ja=new RegExp("\\b"+c+"\\|\\b","i"),W=$.grep(z,function(a){return ja.test(a[0])}),ka=new RegExp(c,"i");z=$.grep(z,function(a){return 0>$.inArray(a,W)&&ka.test(a[0])});var la=/ol$/i;A=$.grep(e,function(a){return la.test(a[0])});$.grep(A,function(a){return S.test(a[0])&&0>$.inArray(a,L)});var ma=new RegExp("^"+c+"|\\|"+c+"|\\/"+c+"|\\*"+c,"i");A=$.grep(A,function(a){return ma.test(a[0])&&0>$.inArray(a,L)});var na=new RegExp("\\b"+c+"\\|\\b","i"),X=$.grep(A,function(a){return na.test(a[0])}),
oa=new RegExp(c,"i");A=$.grep(A,function(a){return 0>$.inArray(a,X)&&oa.test(a[0])});t=t.sort();w=w.sort();z=z.sort();A=A.sort();t=T.concat(U.concat(t.concat(V.concat(w.concat(W.concat(z.concat(X.concat(A))))))));""==$("#"+l).val()&&""==c&&t.insert(100,h);if(0<t.length)for(w=0;w<t.length;w++){z=t[w][1];A=t[w][2];C=t[w][3];G=t[w][4];var E=t[w][0].toString().split("|");H=E[0].trim();I=E[1].trim();var D=E[2].trim(),M=E[3].trim(),N=E[4].trim(),J=E[5];E=E[6];if(""!=c)if(customJsonFlag&&-1<l.indexOf("bw-from")){if(""!=
$("#"+l).val()){var u=$("#"+l).val().split(" ");var O=u[u.length-1]}else O=D;$.each(fromToCountryJson1,function(a,b){-1<b.fromtoCountryListOrigin.indexOf(O.toUpperCase())&&(r=b.fromtoCountryListOrigin,"selectRoutesDestination"==b.fromtoCountryListDestination?q=b.fromtoCountryList:"allRoutes"==b.fromtoCountryListDestination&&(q=""))})}else if(customJsonFlag&&-1<l.indexOf("bw-to"))if(""!=$("#bw-from").val())u=$("#bw-from").val().split(" "),O=u[u.length-1],$.each(fromToCountryJson1,function(a,b){-1<
b.fromtoCountryListOrigin.indexOf(O.toUpperCase())&&("selectRoutesDestination"==b.fromtoCountryListDestination?q=b.fromtoCountryList:"allRoutes"==b.fromtoCountryListDestination&&(q=""))});else return!1;else{$("#"+l).closest(".bw-autocomplete").find(".tt-menu").removeClass("nearyou-height");if(-1<l.indexOf("bw-from")&&void 0!=n&&0<n.length&&D==n[0].shorthand&&void 0!=K&&1==K)continue;if(-1<l.indexOf("bw-to")&&void 0!=v&&0<v.length&&-1<$.inArray(D,y)&&void 0!=K&&K<=y.length)continue}else if(customJsonFlag&&
-1<l.indexOf("bw-from"))r=customFromIataCodes;else if(customJsonFlag&&-1<l.indexOf("bw-to"))if(""!=$("#bw-from").val())u=$("#bw-from").val().split(" "),O=u[u.length-1],$.each(fromToCountryJson1,function(a,b){-1<b.fromtoCountryListOrigin.indexOf(O.toUpperCase())&&("selectRoutesDestination"==b.fromtoCountryListDestination?q=b.fromtoCountryList:"allRoutes"==b.fromtoCountryListDestination&&(q=""))});else return!1;else{if(-1<l.indexOf("bw-from")&&void 0!=n&&0<n.length&&D==n[0].shorthand&&void 0!=K&&1<
K){$("#"+l).closest(".bw-autocomplete").find(".tt-menu").addClass("nearyou-height");continue}if(-1<l.indexOf("bw-to")&&void 0!=v&&0<v.length&&-1<$.inArray(D,y)&&void 0!=K&&K>y.length){$("#"+l).closest(".bw-autocomplete").find(".tt-menu").addClass("nearyou-height");continue}}$(".bookingwizard").find(".nav.inner-tabs li.active").find(".stop-in-doha-tab").length&&void 0!=p&&-1==p.indexOf(J)?"bw-to"==l?(u=$(this.$el[0].parentElement.parentElement).closest(".bw-autocomplete").prev().prev().find(".inputText"),
u=u.val(),u=u.split(" "),u=u[u.length-1],u!=D&&b.push({city:H,shorthand:D,airport:I,cityCode:M,country:N,countryCode:J,priority:E,video:z,map:A,railStation:C,busStation:G})):(b.push({city:H,shorthand:D,airport:I,cityCode:M,country:N,countryCode:J,priority:E,video:z,map:A,railStation:C,busStation:G}),autoFromCountrycode=J):$(".bookingwizard").find(".nav.inner-tabs li.active").find(".stop-in-doha-tab").length||(-1<l.indexOf("bw-to")?(u=$(this.$el[0].parentElement.parentElement).closest(".bw-autocomplete").prev().prev().find(".inputText"),
u=u.val(),u=u.split(" "),u=u[u.length-1],u!=D&&(customJsonFlag&&"multicityTrip"!=$("#tripType").attr("data-value")&&0<fromToCountryJson1.length&&void 0!=q&&""!=q?-1<q.indexOf(D)&&b.push({city:H,shorthand:D,airport:I,cityCode:M,country:N,countryCode:J,priority:E,video:z,map:A,railStation:C,busStation:G}):b.push({city:H,shorthand:D,airport:I,cityCode:M,country:N,countryCode:J,priority:E,video:z,map:A,railStation:C,busStation:G}))):"flightStatusto"==l?(u=$("#flightStatusFrom").val(),u=u.split(" "),u=
u[u.length-1],u!=D&&b.push({city:H,shorthand:D,airport:I,cityCode:M,country:N,countryCode:J,priority:E,video:z,map:A,railStation:C,busStation:G})):customJsonFlag&&-1<l.indexOf("bw-from")&&"multicityTrip"!=$("#tripType").attr("data-value")&&0<fromToCountryJson1.length&&void 0!=r&&""!=r?-1<r.indexOf(D)&&b.push({city:H,shorthand:D,airport:I,cityCode:M,country:N,countryCode:J,priority:E,video:z,map:A,railStation:C,busStation:G}):b.push({city:H,shorthand:D,airport:I,cityCode:M,country:N,countryCode:J,
priority:E,video:z,map:A,railStation:C,busStation:G}))}g(b);var P=!1,Q=!1,R=!1;g=$("#"+l).closest(".twitter-typeahead");$.each(b,function(a,b){300>a&&"Y"==b.railStation?P=!0:300>a&&"Y"==b.busStation?Q=!0:R=!0});1===b.length&&("Y"==b[0].railStation?(g.find(".tt-dataset-location h3").removeClass("show-title"),g.find(".tt-dataset-location h3").eq(1).addClass("show-title")):"Y"==b[0].busStation?(g.find(".tt-dataset-location h3").removeClass("show-title"),g.find(".tt-dataset-location h3:last").addClass("show-title")):
(g.find(".tt-dataset-location h3").removeClass("show-title"),g.find(".tt-dataset-location h3:first-child").addClass("show-title")));R&&P&&Q?$("#"+l).closest("#book").length&&($("#"+l).closest(".bw-autocomplete").addClass("hiderailflybus"),$("#"+l).closest(".bw-autocomplete").find(".autosuggest-tabs").addClass("show-autotabs"),$("#"+l).closest(".bw-autocomplete").find(".suggestion-list").length||$("#"+l).closest(".bw-autocomplete").find(".tt-dataset").not(".tt-dataset:first-child").wrapAll("\x3cdiv class\x3d'suggestion-list' /\x3e"),
g.find("a.nav-link").show()):R&&P&&!Q?$("#"+l).closest("#book").length&&(g.find("a.nav-link#rail-tab").show(),g.find("a.nav-link#airport-tab").show(),g.find("a.nav-link#bus-tab").hide(),$("#"+l).closest(".bw-autocomplete").addClass("hiderailflybus"),$("#"+l).closest(".bw-autocomplete").find(".autosuggest-tabs").addClass("show-autotabs"),$("#"+l).closest(".bw-autocomplete").find(".suggestion-list").length||$("#"+l).closest(".bw-autocomplete").find(".tt-dataset").not(".tt-dataset:first-child").wrapAll("\x3cdiv class\x3d'suggestion-list' /\x3e")):
R&&Q&&!P?$("#"+l).closest("#book").length&&(g.find("a.nav-link#rail-tab").hide(),$("#"+l).closest(".bw-autocomplete").addClass("hiderailflybus"),g.find("a.nav-link#bus-tab").show(),g.find("a.nav-link#airport-tab").show(),$("#"+l).closest(".bw-autocomplete").find(".autosuggest-tabs").addClass("show-autotabs"),$("#"+l).closest(".bw-autocomplete").find(".suggestion-list").length||$("#"+l).closest(".bw-autocomplete").find(".tt-dataset").not(".tt-dataset:first-child").wrapAll("\x3cdiv class\x3d'suggestion-list' /\x3e")):
P&&Q&&!R&&$("#"+l).closest("#book").length&&($("#"+l).closest(".bw-autocomplete").addClass("showrail"),g.find("a.nav-link#airport-tab").hide(),g.find("a.nav-link#bus-tab").show(),g.find("a.nav-link#rail-tab").show(),g.find("a.nav-link#rail-tab").addClass("active"),$("#"+l).closest(".bw-autocomplete").addClass("hiderailflybus"),$("#"+l).closest(".bw-autocomplete").find(".autosuggest-tabs").addClass("show-autotabs"),$("#"+l).closest(".bw-autocomplete").find(".suggestion-list").length||$("#"+l).closest(".bw-autocomplete").find(".tt-dataset").not(".tt-dataset:first-child").wrapAll("\x3cdiv class\x3d'suggestion-list' /\x3e"));
R||P||Q||($("#"+l).closest(".bw-autocomplete").find(".autosuggest-tabs").removeClass("show-autotabs"),$("#"+l).closest(".bw-autocomplete").removeClass("showrail"),$("#"+l).closest(".bw-autocomplete").removeClass("hiderailflybus"),$("#"+l).closest(".bw-autocomplete").find(".railCity").css("display","block"),$("#"+l).closest(".bw-autocomplete").find(".flyCity").css("display","block"),$("#"+l).closest(".bw-autocomplete").find(".busCity").css("display","block"));$("#"+l).closest(".bw-autocomplete").find(".autosuggest-tabs").hasClass("show-autotabs")?
$("#"+l).closest(".bw-autocomplete").find(".tt-menu").addClass("no-scroll"):$("#"+l).closest(".bw-autocomplete").find(".tt-menu").removeClass("no-scroll");setTimeout(function(){d=b.length;$("#"+l).closest(".bw-autocomplete-suggestion").find(".tt-menu").hasClass("tt-open")&&0<d&&$("#"+l).parents(".bw-autocomplete-suggestion").find("label span").text(d+" results are available, use up and down arrow keys to navigate")},300)}}var h=$("#stopOver-configValues"),p=h.data("restricted-countries");h.data("return-disabled-countries");
h.data("oneway-disabled-countries");$("#destinationPrice-details").data("dp-routestype");h=$("#destinationPrice-details").data("dp-origins");var r,q;void 0!=h&&(h=h.map(function(a){return a.toUpperCase()}));if(void 0!=window.shortHand&&null!=window.shortHand&&""!=window.shortHand&&0< !$(".fifa-shuttle-enabled").length)var n=window.cityListJSON.filter(function(a){return a.shorthand==window.shortHand});if("undefined"!=typeof trendingDests&&0<trendingDests.length&&0< !$(".fifa-shuttle-enabled").length)var y=
trendingDests.splice(0,3),v=window.cityListJSON.filter(function(a){return-1!=y.indexOf(a.shorthand)});$(this).each(function(){var f=$(this);$(this).typeahead({hint:!1,minLength:0,highlight:!0},{source:c(""),templates:{notFound:['\x3cdiv class\x3d"tt-none"\x3e\n\x3cul class\x3d"nav nav-tabs autosuggest-tabs" role\x3d"tablist"\x3e\n\x3cli class\x3d"nav-item"\x3e','\x3ca class\x3d"nav-link active" id\x3d"airport-tab" data-toggle\x3d"tab" href\x3d"#airports" role\x3d"tab" aria-controls\x3d"airports" aria-selected\x3d"false"\x3e'+
Granite.I18n.get("airports")+"\x3c/a\x3e",'\x3c/li\x3e\n\x3cli class\x3d"nav-item"\x3e','\x3ca class\x3d"nav-link" id\x3d"rail-tab" data-toggle\x3d"tab" href\x3d"#rail" role\x3d"tab" aria-controls\x3d"rail" aria-selected\x3d"false"\x3e'+Granite.I18n.get("railStations")+"\x3c/a\x3e",'\x3c/li\x3e\n\x3cli class\x3d"nav-item"\x3e','\x3ca class\x3d"nav-link" id\x3d"bus-tab" data-toggle\x3d"tab" href\x3d"#bus" role\x3d"tab" aria-controls\x3d"bus" aria-selected\x3d"false"\x3e'+Granite.I18n.get("busStations")+
"\x3c/a\x3e","\x3c/li\x3e\n\x3c/ul\x3e\n\x3c/div\x3e"].join("\n")}},{name:"current",limit:3,source:c("bw-from"==f.attr("id")?n:""),display:function(a){return a.city.split("*")[0]+" - "+a.airport+"("+a.shorthand+") - "+a.country},templates:{header:["\x3ch3\x3e"+Granite.I18n.get("near.you")+"\x3c/h3\x3e"].join("\n"),suggestion:function(c){var d=c.city.split("*"),b="";c.airport==Granite.I18n.get("all.airports")&&(b="locationCity");return'\x3cdiv class\x3d"tt-suggestion tt-selectable '+a(c)+" "+b+'" role\x3d"menuitem" '+
(void 0!=bwbxtdEventMap.get(c.shorthand)?"onclick\x3d\"return sendBXTrackingEventNew('"+bwbxtdEventMap.get(c.shorthand)+"');\"":"")+"\x3e\x3cstrong\x3e"+d[0]+'\x3c/strong\x3e\x3cspan class\x3d"countrycode"\x3e'+c.country+'\x3c/span\x3e\x3cstrong class\x3d"iatacode"\x3e'+c.shorthand+'\x3c/strong\x3e\x3cspan class\x3d"airport"\x3e'+c.airport+"\x3c/span\x3e\x3c/div\x3e"}}},{name:"trenddest",limit:3,source:c("bw-to"==f.attr("id")?v:""),display:function(a){return a.city.split("*")[0]+" - "+a.airport+"("+
a.shorthand+") - "+a.country},templates:{header:["\x3ch3\x3e"+Granite.I18n.get("recomended")+"\x3c/h3\x3e"].join("\n"),suggestion:function(c){var d=c.city.split("*"),b="";c.airport==Granite.I18n.get("all.airports")&&(b="locationCity");return'\x3cdiv class\x3d"tt-suggestion tt-selectable '+a(c)+" "+b+'" role\x3d"menuitem" '+(void 0!=bwbxtdEventMap.get(c.shorthand)?"onclick\x3d\"return sendBXTrackingEventNew('"+bwbxtdEventMap.get(c.shorthand)+"');\"":"")+"\x3e\x3cstrong\x3e"+d[0]+'\x3c/strong\x3e\x3cspan class\x3d"countrycode"\x3e'+
c.country+'\x3c/span\x3e\x3cstrong class\x3d"iatacode"\x3e'+c.shorthand+'\x3c/strong\x3e\x3cspan class\x3d"airport"\x3e'+c.airport+"\x3c/span\x3e\x3c/div\x3e"}}},{name:"location",limit:300,source:c(window.cityListJSON),display:function(a){return a.city.split("*")[0]+" - "+a.airport+"("+a.shorthand+") - "+a.country},templates:{header:['\x3ch3 class\x3d"show-title"\x3e'+Granite.I18n.get("all.airports")+"\x3c/h3\x3e\x3ch3\x3e"+Granite.I18n.get("all.railStations")+"\x3c/h3\x3e\x3ch3\x3e"+Granite.I18n.get("all.busStations")+
"\x3c/h3\x3e"].join("\n"),suggestion:function(c){var d=c.city.split("*"),b="";c.airport==Granite.I18n.get("all.airports")&&(b="locationCity");return'\x3cdiv class\x3d"tt-suggestion tt-selectable '+a(c)+" "+b+'" role\x3d"menuitem" '+(void 0!=bwbxtdEventMap.get(c.shorthand)?"onclick\x3d\"return sendBXTrackingEventNew('"+bwbxtdEventMap.get(c.shorthand)+"');\"":"")+"\x3e\x3cstrong\x3e"+d[0]+'\x3c/strong\x3e\x3cspan class\x3d"countrycode"\x3e'+c.country+'\x3c/span\x3e\x3cstrong class\x3d"iatacode"\x3e'+
c.shorthand+'\x3c/strong\x3e\x3cspan class\x3d"airport"\x3e'+c.airport+"\x3c/span\x3e\x3c/div\x3e"},empty:['\x3cdiv class\x3d"tt-nomatch"\x3e',"\x3ch3\x3e"+Granite.I18n.get("all.locations")+"\x3c/h3\x3e",'\x3cdiv class\x3d"tt-empty"\x3e\x3cstrong\x3e'+Granite.I18n.get("nocitymatching")+"\x3c/strong\x3e","\x3cp\x3e"+Granite.I18n.get("nocitymatching.moreinfo")+"\x3c/p\x3e\x3c/div\x3e","\x3c/div\x3e"].join("\n")}}).on("typeahead:selected",function(a,c){a=c.city.split("*");$(this).closest(".bw-autocomplete").addClass("filled");
$(this).typeahead("val",a[0]+" "+c.shorthand);$(this).attr("value",a[0]+" "+c.shorthand);var b=$(this);if(-1!=$(this).attr("id").indexOf("bw-from")){a=$(this).closest(".form-group").find(".flightto").find(".inputText");var d=a.val();if(""!=d&&void 0!=d){var e=d.split(" ");e=e[e.length-1];e==c.shorthand&&(a.closest(".bw-autocomplete").removeClass("filled"),a.val(""),a.attr("value",""),a.typeahead("val",""))}""!=d&&customJsonFlag&&void 0!=q&&""!=q&&-1==q.indexOf(e)&&(a.closest(".bw-autocomplete").removeClass("filled"),
a.val(""),a.attr("value",""),a.typeahead("val",""));setTimeout(function(){767>=$(window).width()&&b.parents(".bw-autocomplete").length&&(b.parents(".bw-autocomplete").find(".bw-autocomplete-suggestion").removeClass("onFocus"),b.parents(".bw-autocomplete").removeClass("autoComplete-open"))},200);""==a.val()&&a.typeahead("val","a").typeahead("val","");a.focus()}else if(767>=$(window).width()&&$(this).parents(".bw-autocomplete").length&&($("#bw-from").parents(".bw-autocomplete").find(".bw-autocomplete-suggestion").removeClass("onFocus"),
$("#bw-from").parents(".bw-autocomplete").removeClass("autoComplete-open"),$(this).parents(".bw-autocomplete").find(".bw-autocomplete-suggestion").removeClass("onFocus"),$(this).parents(".bw-autocomplete").removeClass("autoComplete-open"),$(document).find("#header").show(),$("html, body").removeClass("fixed-top"),/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream&&($("#header").height(),$(window).animate({scrollTop:window.inputPosition},100))),$(this).closest(".form-group").next().hasClass("datePickerCol"))$($(this).closest(".form-group").parent().find(".datePickerCol")[0]).find(".qr-datepicker").focus();
else if(0<$(this).closest(".fifa-shuttle-enabled").length)$(this).blur(),$($(this).closest(".form-group").parent().find(".datePickerCol")[0]).find(".qr-datepicker").qDatepicker("show");else{var f=$(this);setTimeout(function(){f.parents(".flightsearchform").find(".triptypeselect .dropdown").addClass("show");f.parents(".flightsearchform").find(".triptypeselect .dropdown #tripType").attr("aria-expanded","true").focus();f.parents(".flightsearchform").find(".triptypeselect .dropdown .dropdown-menu").addClass("show");
1023<=$(window).width()&&"multicityTrip"!=$("#tripType").attr("data-value")?f.parents(".flightsearchform").find(".triptypeselect").css("height","60px"):1023<=$(window).width()&&"multicityTrip"==$("#tripType").attr("data-value")&&f.parents(".flightsearchform").find(".triptypeselect .dropdown.show").css("width","25%")},250)}$(this).closest(".twitter-typeahead").find(".autosuggest-tabs").hasClass("show-autotabs")?$(this).closest(".bw-autocomplete").removeClass("showrailflybus"):$(this).closest(".bw-autocomplete").addClass("showrailflybus");
if(-1!=$(this).attr("id").indexOf("bw-from")||-1!=$(this).attr("id").indexOf("bw-to"))displayTeenagerOfw(),enableDisableStopInQatar(),0<qmilesVal&&($(".redemption-flow-dektop").hide(),$(".cashplusmilesinfo").hasClass("hide")||$(".cashplusmilesinfo").addClass("hide"),showAwardBooking(qmilesVal)),"true"==$("#covidModelEnble").val()&&displayCovidLink()}).on("keyup",function(a){$(this).parents(".bw-autocomplete").find(".previous-search-drop").css("display","none");$(this).closest(".bw-autocomplete").removeClass("showrailflybus");
if(9==a.which||39==a.which){if(""!=$(this).val()&&-1<$(this).val().indexOf("-")){var c=$(this).val().split("-");a=c[1].substr(c[1].indexOf("(")).slice(1,-2);c=(c[0]+a).trim();$(this).closest(".bw-autocomplete").addClass("filled");$(this).typeahead("val",c);$(this).attr("value",c);$(this).closest(".bookingwidget-wrapper").length||$(this).blur();if(-1!=$(this).attr("id").indexOf("bw-from")||-1!=$(this).attr("id").indexOf("flightStatusFrom")){c=-1!=$(this).attr("id").indexOf("flightStatusFrom")?$(this).closest(".flightsearchform").find(".flightto").find(".inputText"):
$(this).closest(".form-group").find(".flightto").find(".inputText");var b=c.val();if(""!=b){var d=b.split(" ");d=d[d.length-1];d==a&&(c.closest(".bw-autocomplete").removeClass("filled"),c.val(""),c.attr("value",""),c.typeahead("val",""))}""!=b&&customJsonFlag&&void 0!=q&&""!=q&&-1==q.indexOf(d)&&(c.closest(".bw-autocomplete").removeClass("filled"),c.val(""),c.attr("value",""),c.typeahead("val",""));if(767>=$(window).width()&&$(this).parents(".bw-autocomplete").length){var e=$(this);setTimeout(function(){e.parents(".bw-autocomplete").find(".bw-autocomplete-suggestion").removeClass("onFocus");
e.parents(".bw-autocomplete").removeClass("autoComplete-open")},200)}""==c.val()&&c.typeahead("val","a").typeahead("val","");c.focus()}else if(767>=$(window).width()&&$(this).parents(".bw-autocomplete").length&&($("#bw-from").parents(".bw-autocomplete").find(".bw-autocomplete-suggestion").removeClass("onFocus"),$("#bw-from").parents(".bw-autocomplete").removeClass("autoComplete-open"),$(this).parents(".bw-autocomplete").find(".bw-autocomplete-suggestion").removeClass("onFocus"),$(this).parents(".bw-autocomplete").removeClass("autoComplete-open"),
$(document).find("#header").show(),$("html, body").removeClass("fixed-top"),/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream&&($("#header").height(),$(window).animate({scrollTop:window.inputPosition},100))),$(this).closest(".form-group").next().hasClass("datePickerCol"))$($(this).closest(".form-group").parent().find(".datePickerCol")[0]).find(".qr-datepicker").focus();else{var f=$(this);0<$(this).closest(".fifa-shuttle-enabled").length?($(this).blur(),$($(this).closest(".form-group").parent().find(".datePickerCol")[0]).find(".qr-datepicker").qDatepicker("show")):
setTimeout(function(){f.parents(".flightsearchform").find(".triptypeselect .dropdown").addClass("show");f.parents(".flightsearchform").find(".triptypeselect .dropdown #tripType").attr("aria-expanded","true").focus();f.parents(".flightsearchform").find(".triptypeselect .dropdown .dropdown-menu").addClass("show");1023<=$(window).width()&&"multicityTrip"!=$("#tripType").attr("data-value")?f.parents(".flightsearchform").find(".triptypeselect").css("height","60px"):1023<=$(window).width()&&"multicityTrip"==
$("#tripType").attr("data-value")&&f.parents(".flightsearchform").find(".triptypeselect .dropdown.show").css("width","25%")},250);-1!=$(this).attr("id").indexOf("flightStatusto")&&$(this).closest(".flightsearchform").find("#flightDateRange").focus()}$(this).closest(".twitter-typeahead").find(".autosuggest-tabs").hasClass("show-autotabs")?$(this).closest(".bw-autocomplete").removeClass("showrailflybus"):$(this).closest(".bw-autocomplete").addClass("showrailflybus");if(-1!=$(this).attr("id").indexOf("bw-from")||
-1!=$(this).attr("id").indexOf("bw-to"))displayTeenagerOfw(),enableDisableStopInQatar(),0<qmilesVal&&($(".redemption-flow-dektop").hide(),$(".cashplusmilesinfo").hasClass("hide")||$(".cashplusmilesinfo").addClass("hide"),showAwardBooking(qmilesVal)),"true"==$("#covidModelEnble").val()&&displayCovidLink()}}else if((8==a.which||46==a.which)&&""==$(this).val()){$(this).closest(".bw-autocomplete").removeClass("filled");if(-1!=$(this).attr("id").indexOf("bw-from")||-1!=$(this).attr("id").indexOf("bw-to"))displayTeenagerOfw(),
enableDisableStopInQatar(),0<qmilesVal&&($(".redemption-flow-dektop").hide(),$(".cashplusmilesinfo").hasClass("hide")||$(".cashplusmilesinfo").addClass("hide"),showAwardBooking(qmilesVal)),"true"==$("#covidModelEnble").val()&&displayCovidLink();$(this).closest(".bw-autocomplete").removeClass("showrailflybus")}})});$(".inputText",".bw-autocomplete").on("focus blur",function(a){var c=$(this).closest(".bw-autocomplete").find(".floating-label"),f=!1,b=$(this);"focus"===a.type?(c.addClass("active"),767>=
$(window).width()&&1!=b.parents(".campaign-form").length&&b.closest(".bw-autocomplete").length&&(f||(a=$(window).scrollTop(),0!=a&&(window.inputPosition=a),f=!0),b.parents(".bw-autocomplete-suggestion").addClass("onFocus"),b.parents(".bw-autocomplete").addClass("autoComplete-open"),$(document).find("#header").hide(),$("html, body").addClass("fixed-top"),/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream&&$("html, body").stop().animate({scrollTop:0},500,"swing")),b.on("click",function(a){b.select()})):
"blur"===a.type&&c.removeClass("active");0<b.val().length&&c.addClass("active");if(b.closest(".flightsearchform").length&&-1!=b.attr("id").indexOf("bw-to")){c=b.closest(".form-group").find(".flightfrom .inputText");a=c.val().split(" ");var h=a[a.length-1],e=!0;void 0!=c&&0<c.val().length&&(c.parent().find(".tt-menu .tt-suggestion").each(function(){0<$(this).find(".iatacode").length&&h==$(this).find(".iatacode").text()&&(e=!1)}),e&&(c.closest(".bw-autocomplete").removeClass("filled"),c.closest(".bw-autocomplete").find(".floating-label").removeClass("active"),
c.val(""),c.attr("value",""),c.typeahead("val","")))}});$(".triptype").on("click",".dropdown-menu li a",function(){$("#book-flight").find(".stopindohapreferences").hasClass("enable-stopindoha")||setTimeout(displayTeenagerOfw,100)});$(".bw-autocomplete .close-autocomplete").on("click",function(){0<$(this).parents(".autoComplete-open").length&&($(this).parents(".bw-autocomplete").find(".bw-autocomplete-suggestion").removeClass("onFocus"),$(this).parents(".bw-autocomplete").removeClass("autoComplete-open"),
$(document).find("#header").show(),$(this).parents(".bw-autocomplete").find(".previous-search-drop").css("display","none"),$("html, body").removeClass("fixed-top"),/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream&&$(window).animate({scrollTop:window.inputPosition},100))})};$(".swap",".form-group").each(function(){$(this).on("click",swapCity)});$(".bw-autocomplete").on("click",".autosuggest-tabs a",function(){var a=$(this).closest(".tt-menu"),h=$(this).attr("id");"airport-tab"==h?(a.find(".tt-suggestion").css("display",
"none"),a.find(".flyCity").css("display","block"),a.find(".tt-dataset-location h3").removeClass("show-title"),a.find(".tt-dataset-location h3:first-child").addClass("show-title")):"rail-tab"==h?(a.find(".tt-suggestion").css("display","none"),a.find(".railCity").css("display","block"),a.find(".tt-dataset-location h3").removeClass("show-title"),a.find(".tt-dataset-location h3").eq(1).addClass("show-title")):"bus-tab"==h&&(a.find(".tt-suggestion").css("display","none"),a.find(".busCity").css("display",
"block"),a.find(".tt-dataset-location h3").removeClass("show-title"),a.find(".tt-dataset-location h3:last").addClass("show-title"));c($(this))});fromToCountryJson()});
function fromToCountryJson(){var a=$("#bookFlight-config").attr("data-custom-from-tocountrylist");void 0!=a&&(fromToCountryJson1=JSON.parse(a));void 0!=fromToCountryJson1&&0<fromToCountryJson1.length&&(customJsonFlag=!0);customJsonFlag&&$.each(fromToCountryJson1,function(a,f){customFromIataCodes=a<=fromToCountryJson1.length-1?customFromIataCodes+(f.fromtoCountryListOrigin+","):customFromIataCodes+f.fromtoCountryListOrigin})}
function swapCity(){var a=$(this).closest(".form-group").find(".flightfrom .inputText"),c=$(this).closest(".form-group").find(".flightto .inputText"),f=a.val(),h=c.val();$(this).hasClass("active")?$(this).removeClass("active"):$(this).addClass("active");""==f?(c.closest(".flightto").find(".floating-label").removeClass("active"),c.closest(".flightto").removeClass("filled")):(c.closest(".flightto").find(".floating-label").addClass("active"),c.closest(".flightto").addClass("filled"));""==h?(a.closest(".flightfrom").find(".floating-label").removeClass("active"),
a.closest(".flightfrom").removeClass("filled")):(a.closest(".flightfrom").find(".floating-label").addClass("active"),a.closest(".flightfrom").addClass("filled"));a.val(h);a.attr("value",h);a.typeahead("val",h);c.val(f);c.attr("value",f);c.typeahead("val",f);displayTeenagerOfw();enableDisableStopInQatar()}
function displayTeenagerOfw(){var a=$("#tripType").attr("data-value"),c=[];$(".bw-autocomplete:visible","#book-flight").each(function(){if(""!=$(this).find(".inputText").val()){var f=$(this).find(".inputText").val().split(" ");f=f[f.length-1];$(this).hasClass("flightfrom")?c.push(f):$(this).hasClass("flightto")&&"roundTrip"==a&&c.push(f)}});showHideTeenagerOFW(teenager(c),ofw(c));try{"ar"==(void 0!=$(document).find("#langpagename").val()?$(document).find("#langpagename").val():"en")||showHideEmdMessage()||
showHideCashPlusMiles(c)}catch(f){}}
function showHideEmdMessage(){$(".cashplusmilesinfo").addClass("hide");cashplusmilesShown=!1;$(".cashplusmilesinfo").removeClass("emdinfo");return"undefined"!=typeof callFlowResponse&&"undefined"!=typeof callFlowResponse.response&&"undefined"!=typeof callFlowResponse.response.refundType&&"EMD_EXCH"===callFlowResponse.response.refundType?(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?($(".cashplushmilesText").html(Granite.I18n.get("boxever.bw.emdmobilemsg")),$(".cashplushmilesSubtext1").html(""),
$(".cashplushmilesSubtext2").html("")):($(".cashplushmilesText").html(Granite.I18n.get("boxever.bw.emddesktopmsg")),$(".cashplushmilesSubtext1").html(Granite.I18n.get("boxever.bw.emddesktopsubtext")),$(".cashplushmilesSubtext2").html(""),$(".cashplushmilesSubtext2").hide()),$(".cashplusmilesinfo").addClass("emdinfo"),awardBookShown||$(".cashplusmilesinfo").removeClass("hide"),cashplusmilesShown=!0,emdAnalyticsevent&&"true"==$("#sc_variable").val()&&(s.eVar133="bw-travelvoucher",s.prop48="bw-travelvoucher",
s.events="event139",emdAnalyticsevent=!1,s.t()),!0):!1}
function showHideCashPlusMiles(a){var c=[],f=!1;$(".cashplusmilesinfo").addClass("hide");cashplusmilesShown=!1;$(".cashplusmilesinfo").removeClass("emdinfo");var h="AU CY CZ NL NZ HU ES PL".split(" ");c=window.cityListJSON.filter(function(c,f){return-1!=a.indexOf(c.shorthand)});for(k=0;k<c.length;k++)-1!=h.indexOf(c[k].countryCode)&&(f=!0);0==a.length||f||null==getFFPCookieValue("QRTOKEN")||""==getFFPCookieValue("QRTOKEN")||"undefined"==typeof flowExecutionResponse||"undefined"==typeof flowExecutionResponse.offerContent||
(c=void 0!=flowExecutionResponse.offerContent.qmilesitems?flowExecutionResponse.offerContent.qmilesitems:"",c=""!=c&&0!=c.length&&void 0!=c[0].destinations&&0<c[0].destinations.length?c[0].destinations:null,f="",void 0!=flowExecutionResponse.offerContent.showQmName&&flowExecutionResponse.offerContent.showQmName&&(f=null!=getUserBasicInfoField("firstName")?getUserBasicInfoField("firstName")+", ":""),h=null!=getUserBasicInfoField("qmilesAmount")?getUserBasicInfoField("qmilesAmount"):0,800<parseInt(h)||
null!=c&&2<c.length?($(".cashplushmilesText").html(f+""+Granite.I18n.get("boxever.bw.cashplushmilesText")),$(".cashplushmilesSubtext1").html(Granite.I18n.get("boxever.bw.cashplushmilessubText1")),$(".cashplushmilesSubtext2").html(Granite.I18n.get("boxever.bw.cashplushmilessubText2")),awardBookShown||$(".cashplusmilesinfo").removeClass("hide"),cashplusmilesShown=!0,emdAnalyticsevent&&"true"==$("#sc_variable").val()&&(s.eVar133="bw-cash+qmiles",s.prop48="bw-cash+qmiles",s.events="event139",emdAnalyticsevent=
!1,s.t())):($(".cashplusmilesinfo").addClass("hide"),cashplusmilesShown=!1))}function teenager(a){var c,f=!1,h="BFS BHD BHX BRS CWL EDI EXT GCI GLA INV IOM JER LBA LGW LHR MAN MME NCL NQY NWI SOU ABZ LCY QQU ZEP LTN LON".split(" ");$.each(a,function(a,r){(c=-1!=$.inArray(r,h))&&(f=!0)});return f}
function ofw(a){var c,f=!1,h="CRK MNL BCD BSO BXU CBO CEB CGY CRM CYP DGP DPL DVO GES ILO KLO LAO LGP OZC MBT MPH PPS RXS SUG OZC TAC TAG TBH TUG USU WNP ZAM".split(" ");$.each(a,function(a,r){(c=-1!=$.inArray(r,h))&&(f=!0)});return f}
function showHideTeenagerOFW(a,c){var f=$(".passengers-picker").find(".teenager-row"),h=$("#teenager",".passengers-picker"),p=$(".passengers-picker").find(".ofw-row"),r=$("#ofw",".passengers-picker"),q=$(".passengers-picker").find(".adult-row"),n=$("#adult",".passengers-picker"),y=$("#child",".passengers-picker"),v=$("#infant",".passengers-picker"),x=q.find("select").val();x=Number(x);var d=$("#langpagename").val();Granite.I18n.setLocale(d);if(a&&"none"==f.css("display")){f.css("display","flex");
767<$(window).width()?(f=Granite.I18n.get("adults")+"("+Granite.I18n.get("16+years")+")",q.find("label").text(f)):q.find("label.dupmobilelabel").html(Granite.I18n.get("adults")+"\x3cbr/\x3e\x3cspan\x3e"+Granite.I18n.get("16+years")+"\x3c/span\x3e");n.find("option[value\x3d0]").length||n.prepend("\x3coption value\x3d'0'\x3e0\x3c/option\x3e");h.empty();for(f=0;f<=9-n.val();f++)h.append("\x3coption value\x3d'"+f+"'\x3e"+f+"\x3c/option\x3e");"undefined"!=typeof psteenagerval?h.val(psteenagerval).change():
h.val("0").change()}else a||"none"==f.css("display")||(h=f.find("select").val(),x+=Number(h),f.hide(),f.find("select").val("0").change(),767<$(window).width()?(f=Granite.I18n.get("adults")+"("+Granite.I18n.get("12years")+")",q.find("label").text(f)):q.find("label.dupmobilelabel").html(Granite.I18n.get("adults")+"\x3cbr/\x3e\x3cspan\x3e"+Granite.I18n.get("12years")+"\x3c/span\x3e"),q.find("select").find("option[value\x3d0]").length&&!c&&q.find("select").find("option[value\x3d0]").remove(),q.find("select").val(x).change());
if(c&&"none"==p.css("display")){p.css("display","flex");n.find("option[value\x3d0]").length||n.prepend("\x3coption value\x3d'0'\x3e0\x3c/option\x3e");r.empty();for(a=0;a<=9-n.val();a++)r.append("\x3coption value\x3d'"+a+"'\x3e"+a+"\x3c/option\x3e");"undefined"!=typeof psofw?r.val(psofw).change():r.val("0").change()}else c||"none"==p.css("display")||(r=p.find("select").val(),x+=Number(r),p.hide(),p.find("select").val("0").change(),q.find("select").find("option[value\x3d0]").length&&!a&&q.find("select").find("option[value\x3d0]").remove(),
q.find("select").val(x).change());"undefined"!=typeof pschild?y.val(pschild).change():y.val("0").change();"undefined"!=typeof psinfant?v.val(psinfant).change():v.val("0").change()}var bxpsEventMap=new Map,psViewEvents=[],bxPrevSViewed=!1,bxprevSrch=!1,bxPrevSVariant="",psteenagerval="0",psofw="0",pschild="0",psinfant="0";
$(function(){var a=$("#bw-from").closest(".flightfrom").find(".previous-search-drop");$(".flightsearh-btn").on("click",function(){"multicityTrip"==$("#tripType").attr("data-value")||$("#book").find(".stop-in-doha-tab").hasClass("active")||previousSearch()});"undefined"!==typeof removeAutoFillValues||window.callJson&&"undefined"!=window.callJson||(cityList(),$("#bw-from:visible,#bw-to:visible",".bw-autocomplete").bwAutocomplete(),window.callJson=!0,bwAutoPopulate());$(".previous-search-drop ul").on("click",
"li",function(){var a=$(this);populateBWData(a)});$("#bw-from").on("click keyup",function(c){"multicityTrip"!=$("#tripType").attr("data-value")&&0< !$(this).closest(".tab-pane").find(".enable-stopindoha").length&&(null!=localStorage.getItem("bwhistory")&&""!=localStorage.getItem("bwhistory")&&("click"===c.type||"keyup"===c.type&&9===c.keyCode)?"block"==a.css("display")?a.fadeOut():(a.fadeIn(),bxPrevSrchEvents()):a.fadeOut())});$(document).on("click keyup",function(c){0==$(c.target).closest(".flightfrom").length&&
a.fadeOut()})});function bxPrevSrchEvents(){if(!bxPrevSViewed){for(var a=0;a<psViewEvents.length;a++)sendBXTrackingEventNew(psViewEvents[a]);bxPrevSViewed=!0}}function convertDateYear(a,c){if(""!=a&&void 0!=a)return c=c.split("-")[0],void 0!=a.split(" ")[1]?(a=a.split(" "),a[0]+" "+a[1]+" "+c):a}String.prototype.toTitle=function(){return this.replace(/(^|\s)\S/g,function(a){return a.toUpperCase()})};
var monthNames=[Granite.I18n.get("booking.month.january"),Granite.I18n.get("booking.month.february"),Granite.I18n.get("booking.month.march"),Granite.I18n.get("booking.month.april"),Granite.I18n.get("booking.month.may"),Granite.I18n.get("booking.month.june"),Granite.I18n.get("booking.month.july"),Granite.I18n.get("booking.month.august"),Granite.I18n.get("booking.month.september"),Granite.I18n.get("booking.month.october"),Granite.I18n.get("booking.month.november"),Granite.I18n.get("booking.month.december")];
function previousSearchBX(a){if(""!=a&&!$.isEmptyObject(a.personalizedHeaderResults.prefillSearch)){var c=localStorage.getItem("bwhistory"),f=[],h=[],p=[];if(null!=c&&""!=c)for(p=c.split("|"),i=0;i<p.length;i++)f.push(JSON.parse(p[i]));bxPrevSVariant=void 0!=a.personalizedHeaderResults.variant?a.personalizedHeaderResults.variant:"";a=a.personalizedHeaderResults.prefillSearch;for(i=0;i<a.length;i++){c=parseInt(a[i].adults)+parseInt(a[i].teenager)+parseInt(a[i].ofw)+parseInt(a[i].children)+parseInt(a[i].infants);
p=a[i].start.split("T")[0];var r=a[i].end.split("T")[0],q=p.split("-"),n=r.split("-");q=q[2]+" "+monthNames[parseInt(q[1])-1].substr(0,3).toTitle()+" "+q[0].slice(-2);n=n[2]+" "+monthNames[parseInt(n[1])-1].substr(0,3).toTitle()+" "+n[0].slice(-2);c={from:a[i].origin,to:a[i].destination,departDateLang:p,arrivalDateLang:r,departDate:q,arrivalDate:n,passengers:c,adults:a[i].adults,teenagers:a[i].teenager,ofw:a[i].ofw,child:a[i].children,infant:a[i].infants,promo:"",premiumOnly:"Economy"==a[i].cabinClass?
"economyclass":"premiumclass",tripType:"OW"==a[i].flight_type?!0:!1,createdAt:a[i].createdAt};bxpsEventMap.set(c.from+"_"+c.to+"_"+c.premiumOnly+"_"+c.tripType,"HPBW_PS_"+c.from+"-"+c.to+"_POS"+i+"_CLICKED");psViewEvents.push("HPBW_PS_"+c.from+"-"+c.to+"_POS"+i+"_VIEWED");f.push(c)}f.sort(function(a,c){return new Date(c.createdAt)-new Date(a.createdAt)});for(i=0;i<f.length;i++)h.push(JSON.stringify(f[i]));c=duplicateResults(h).join("|");localStorage.setItem("bwhistory",c)}}
function previousSearch(){var a=$("#bw-from").val(),c=$("#bw-to").val();var f="onewayTrip"==$("#tripType").attr("data-value")?!0:!1;var h=$(".qr-datepicker input[name\x3dt-start]").val(),p=$(".qr-datepicker input[name\x3dt-end]").val(),r=$(".qr-datepicker .t-day-check-in").val(),q=$(".qr-datepicker .t-day-check-out").val(),n=parseInt($("#passenger-field").val()),y=$("#adult").val(),v=$("#child").val(),x=$("#infant").val(),d=null!=$("#teenager").val()?$("#teenager").val():"0",g=null!=$("#ofw").val()?
$("#ofw").val():"0",b=$("#cabintype").attr("data-value"),m=$("#promo").val();f={from:a.slice(-3),to:c.slice(-3),departDate:r,departDateLang:h,arrivalDate:q,arrivalDateLang:p,passengers:n,adults:y,teenagers:d,ofw:g,child:v,infant:x,promo:m,premiumOnly:b,tripType:f,createdAt:new Date};""!=a&&""!=c&&""!=r&&""!=n&&(null!=localStorage.getItem("bwhistory")&&""!=localStorage.getItem("bwhistory")?(a=localStorage.getItem("bwhistory"),a=a.split("|"),3==a.length&&a.pop(),a.unshift(JSON.stringify(f)),a=duplicateResults(a).join("|")):
a=JSON.stringify(f),localStorage.setItem("bwhistory",a))}
function duplicateResults(a){var c={};for(f=0;f<a.length;f++)c[JSON.parse(a[f]).from+" - "+JSON.parse(a[f]).to+" - "+JSON.parse(a[f]).departDate+" - "+JSON.parse(a[f]).arrivalDate+" - "+JSON.parse(a[f]).passengers+" - "+JSON.parse(a[f]).adults+" - "+JSON.parse(a[f]).teenagers+" - "+JSON.parse(a[f]).ofw+" - "+JSON.parse(a[f]).child+" - "+JSON.parse(a[f]).infant+" - "+(""==JSON.parse(a[f]).promo?"0":JSON.parse(a[f]).promo)+" - "+JSON.parse(a[f]).premiumOnly+" - "+JSON.parse(a[f]).tripType]=JSON.parse(a[f]);
var f=0;a=[];for(var h in c)3>f&&(a[f++]=JSON.stringify(c[h]),"control"==bxPrevSVariant&&0==psViewEvents.length&&(bxpsEventMap.set(c[h].from+"_"+c[h].to+"_"+c[h].premiumOnly+"_"+c[h].tripType,"HPBW_PSCNTRL_"+c[h].from+"-"+c[h].to+"_POS"+f+"_CLICKED"),psViewEvents.push("HPBW_PSCNTRL_"+c[h].from+"-"+c[h].to+"_POS"+f+"_VIEWED")));return a}
function populateBWData(a){a.closest(".flightfrom").find(".previous-search-drop").css("display","none");var c=a.find("#toIataCode").text(),f=a.find("#fromIataCode").text();a.find("#date").text();a=a.index();var h=localStorage.getItem("bwhistory").split("|");if(h.length>=a&&(a=JSON.parse(h[a]),-1!=a.from.indexOf(f)&&-1!=a.to.indexOf(c))){c=a.from.split(" ");c=c[c.length-1];var p=-1!=c.indexOf("(")?c.substr(1,3):c;c=$.grep(window.cityListJSON,function(a,c){return a.shorthand==p});f=c[0].city.split("*");
$("#bw-from").typeahead("val",f[0]+" "+c[0].shorthand);$("#bw-from").attr("value",f[0]+" "+c[0].shorthand);$("#bw-from").closest(".flightfrom").find(".floating-label").addClass("active");c=a.to.split(" ");c=c[c.length-1];var r=-1!=c.indexOf("(")?c.substr(1,3):c;c=$.grep(window.cityListJSON,function(a,c){return a.shorthand==r});f=c[0].city.split("*");$("#bw-to").typeahead("val",f[0]+" "+c[0].shorthand);$("#bw-to").attr("value",f[0]+" "+c[0].shorthand);$("#bw-to").closest(".flightto").find(".floating-label").addClass("active");
768>$(window).width()&&$("#bw-from").closest(".flightfrom").find(".close-autocomplete").trigger("click");1==a.tripType&&0< !$(".booking-widget").length?($("#book .flightsearchform").addClass("prevSearch"),$(".triptype").find(".dropdown-menu li a#onewayTrip").click(),$(".qr-datepicker").qDatepicker("updateCI",a.departDateLang)):0< !$(".booking-widget").length&&($("#book .flightsearchform").addClass("prevSearch"),$(".triptype").find(".dropdown-menu li a#roundTrip").click(),$(".qr-datepicker").qDatepicker("updateCI",
a.departDateLang),$(".qr-datepicker").qDatepicker("updateCO",a.arrivalDateLang));$("#passenger-field").val(a.passengers);$(".paxbar #adult").val(a.adults).change();0<a.ofw?($(".paxbar #ofw").val(a.ofw).change(),psofw=a.ofw):($(".paxbar #ofw").val("0").change(),psofw="0");0<a.teenagers?($(".paxbar #teenager").val(a.teenagers).change(),psteenagerval=a.teenagers):($(".paxbar #teenager").val("0").change(),psteenagerval="0");pschild=a.child;psinfant=a.infant;$(".paxbar #child").val(a.child).change();$(".paxbar #infant").val(a.infant).change();
"premiumclass"==a.premiumOnly?($("#cabintype").attr("value","premium"),$("#cabintype").attr("data-value","premiumclass"),$("#cabintype").attr("data-show",Granite.I18n.get("premium")),$(".cabin-custom-radio #premiumclass").click()):($("#cabintype").attr("value","economy"),$("#cabintype").attr("data-value","economyclass"),$("#cabintype").attr("data-show",Granite.I18n.get("economy")),$(".cabin-custom-radio #economyclass").click());768<=screen.width&&(a=$("#header").outerHeight(),$("#flights-search-from").closest(".stickyBW").length||
$("html, body").animate({scrollTop:$(".bookingwizard").offset().top-a-50}))}}function getUrlParameter(a){var c=decodeURIComponent(window.location.search.substring(1)).split("\x26"),f;for(f=0;f<c.length;f++){var h=c[f].split("\x3d");if(h[0]===a)return void 0===h[1]?!0:h[1]}}
function bwAutoPopulate(){var a=0,c=0,f=0,h=0;if("undefined"!=typeof bxpmresponse&&void 0!=bxpmresponse&&!$.isEmptyObject(bxpmresponse)){var p=bxpmresponse.fromIataCode;var r=bxpmresponse.toIataCode;var q=bxpmresponse.adults;a=""!=bxpmresponse.teenagers?bxpmresponse.teenagers:0;c=""!=bxpmresponse.ofw?bxpmresponse.ofw:0;f=bxpmresponse.child;h=bxpmresponse.infant;var n=bxpmresponse.cabinClass;var y="RETURN"==bxpmresponse.tripType?"roundTrip":"onewayTrip"}else if(void 0!=getUrlParameter("taskbar")||
void 0!=getUrlParameter("from")||void 0!=getUrlParameter("to")||void 0!=getUrlParameter("adults")||void 0!=getUrlParameter("type")||void 0!=getUrlParameter("class")||void 0!=getUrlParameter("promocode")||void 0!=x){var v="url";p=getUrlParameter("from");r=getUrlParameter("to");q=getUrlParameter("adults");n=getUrlParameter("class");void 0!=getUrlParameter("type")&&(y="return"==getUrlParameter("type")?"roundTrip":"onewayTrip");var x=getUrlParameter("departure");var d=getUrlParameter("arrival");var g=
getUrlParameter("promocode")}else if(void 0!=$("#bookFlight-config").attr("data-default-fromiata")||void 0!=$("#bookFlight-config").attr("data-default-toiata")||void 0!=$("#bookFlight-config").attr("data-default-classtype")&&"none"!=$("#bookFlight-config").attr("data-default-classtype")&&"economy"!=$("#bookFlight-config").attr("data-default-classtype")||void 0!=$("#bookFlight-config").attr("data-desktop-promocode")||void 0!=$("#bookFlight-config").attr("data-mobile-promocode"))v="dialog",p=$("#bookFlight-config").attr("data-default-fromiata"),
r=$("#bookFlight-config").attr("data-default-toiata"),q=$("#bookFlight-config").attr("data-adults-count"),n=$("#bookFlight-config").attr("data-default-classtype"),y="roundtrip"==$("#bookFlight-config").attr("data-default-triptype")?"roundTrip":"onewayTrip",void 0!=$("#bookFlight-config").attr("data-mobile-promocode")&&768>$(window).width()?g=$("#bookFlight-config").attr("data-mobile-promocode"):void 0!=$("#bookFlight-config").attr("data-desktop-promocode")&&(g=$("#bookFlight-config").attr("data-desktop-promocode"));
else if(null!=localStorage.getItem("bwhistory")&&""!=localStorage.getItem("bwhistory")){v="previousSearch";var b=localStorage.getItem("bwhistory").split("|");b=JSON.parse(b[0]);var m=b.from.split(" ");m=m[m.length-1];var e=b.to.split(" ");e=e[e.length-1];p=-1!=m.indexOf("(")?m.substr(1,3):m;r=-1!=e.indexOf("(")?e.substr(1,3):e;x=b.departDateLang;d=b.arrivalDateLang;q=b.adults;a=""!=b.teenagers?b.teenagers:0;c=""!=b.ofw?b.ofw:0;f=b.child;h=b.infant;n=b.premiumOnly;y=1!=b.tripType?"roundTrip":"onewayTrip"}if(customJsonFlag&&
0==$(".fifa-shuttle-enabled").length)return!1;b=$("#pageOriginIata-fare-finder").val();m=$("#pageIata-fare-finder").val();e=$("#originIataCode-fare-finder").val();var B=$("#destinationIatacode-fare-finder").val();void 0!=e&&""!=e&&void 0!=B&&""!=B&&"url"!=v?(p=e,r=B):void 0!=b&&void 0!=m&&"url"!=v&&(p=b,r=m);if(void 0!=p&&null!=p){var F=$.grep(window.cityListJSON,function(a,b){return a.shorthand==p.toUpperCase()});if(F.length){if(void 0==$("#standalone-configValues").attr("data-stopoverenable")||
"true"!=$("#standalone-configValues").attr("data-stopoverenable")||"true"==$("#standalone-configValues").attr("data-flightslinkenable")||"DOH"!=F[0].shorthand)v=F[0].city.split("*"),$("#bw-from").typeahead("val",v[0]+" "+F[0].shorthand),$("#bw-from").attr("value",v[0]+" "+F[0].shorthand),$("#bw-from").closest(".flightfrom").find(".floating-label").addClass("active");autoFromCountrycode=F[0].countryCode}}void 0!=r&&null!=r&&(v=$.grep(window.cityListJSON,function(a,b){return a.shorthand==r.toUpperCase()}),
v.length&&(void 0==$("#standalone-configValues").attr("data-stopoverenable")||"true"!=$("#standalone-configValues").attr("data-stopoverenable")||"true"==$("#standalone-configValues").attr("data-flightslinkenable")||"DOH"!=v[0].shorthand&&"DOH"!=F[0].shorthand)&&(F=v[0].city.split("*"),$("#bw-to").typeahead("val",F[0]+" "+v[0].shorthand),$("#bw-to").attr("value",F[0]+" "+v[0].shorthand),$("#bw-to").closest(".flightto").find(".floating-label").addClass("active")));setTimeout(function(){"onewayTrip"==
y||"ONE_WAY"==y?($("#book .flightsearchform").addClass("prevSearch"),$(".triptype").find(".dropdown-menu li a#onewayTrip").click(),void 0!=x&&0< !$(".booking-widget").length&&$(".qr-datepicker").qDatepicker("updateCI",x)):void 0!=y&&0< !$(".booking-widget").length&&($("#book .flightsearchform").addClass("prevSearch"),$(".triptype").find(".dropdown-menu li a#roundTrip").click(),void 0!=x&&void 0!=d&&($(".qr-datepicker").qDatepicker("updateCI",x),$(".qr-datepicker").qDatepicker("updateCO",d)));void 0!=
q&&($(".paxbar #adult").val(q).change(),0<c?($(".paxbar #ofw").val(c).change(),psofw=c):($(".paxbar #ofw").val("0").change(),psofw="0"),0<a?($(".paxbar #teenager").val(a).change(),psteenagerval=a):($(".paxbar #teenager").val("0").change(),psteenagerval="0"),pschild=f,psinfant=h,$(".paxbar #child").val(f).change(),$(".paxbar #infant").val(h).change());if(void 0!=n&&"premiumclass"==n||"premium"==n&&"none"!=n&&"economy"!=n||"first"==n||"business"==n)$("#cabintype").attr("value","premium"),$("#cabintype").attr("data-value",
"premiumclass"),$("#cabintype").attr("data-show",Granite.I18n.get("premium")),$(".cabin-custom-radio #premiumclass").click();void 0!=g&&($("#ihavePromo").css("display","none"),$(".promocodecontent").css("display","block"),$(".promocode #promo").val(g),$(".promocodecontent").find(".floating-label").addClass("active"),0<$(".fifa-shuttle-enabled").length&&$(".promocode #promo").prop("readonly",!0));0<qmilesVal&&showAwardBooking(qmilesVal);"true"==$("#covidModelEnble").val()&&0< !$(".booking-widget").length&&
displayCovidLink()},600);enableTrendingDest&&0<trendingDests.length&&"multicityTrip"!=$("#tripType").attr("data-value")&&regionToSend.toUpperCase()==autoFromCountrycode&&($("#bw-to").closest(".bw-autocomplete").find(".autosuggest-tabs").addClass("show-autotabs"),$("#bw-to").closest(".bw-autocomplete").find(".tt-suggestion").wrapAll("\x3cdiv class\x3d'suggestion-list' /\x3e"),$("a.nav-link#rail-tab, a.nav-link#airport-tab").hide(),$("a.nav-link#bwtrending-tab, a.nav-link#all-tab").show())};